var $a=Object.defineProperty;var es=Object.getPrototypeOf;var ts=Reflect.get;var la=a=>{throw TypeError(a)};var rs=(a,t,r)=>t in a?$a(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r;var oa=(a,t,r)=>rs(a,typeof t!="symbol"?t+"":t,r),Jr=(a,t,r)=>t.has(a)||la("Cannot "+r);var m=(a,t,r)=>(Jr(a,t,"read from private field"),r?r.call(a):t.get(a)),B=(a,t,r)=>t.has(a)?la("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,r),it=(a,t,r,s)=>(Jr(a,t,"write to private field"),s?s.call(a,r):t.set(a,r),r),Pe=(a,t,r)=>(Jr(a,t,"access private method"),r);var ua=(a,t,r,s)=>({set _(n){it(a,t,n,r)},get _(){return m(a,t,s)}}),ca=(a,t,r)=>ts(es(a),r,t);import{b as da,d as as,f as M,a as k,c as yr,t as er}from"../chunks/BD-3wmyv.js";import{t as V,j as Wr,k as va,aa as ss,ar as ns,z as Fr,ah as is,ak as ls,ai as os,q as us,a8 as fr,i as cs,E as ds,x as vs,N as Pa,as as fs,K as hs,D as Ia,P as gs,c as v,at as xt,g as e,au as ms,s as T,a as be,h as re,av as bs,u as Ke,aw as _s,p as ot,f as fe,e as x,d as p,r as g,b as ut,ax as tr,n as ps}from"../chunks/TmfA6SFC.js";import{e as rr,d as ur,s as Re}from"../chunks/eEg4oSbh.js";import{i as G}from"../chunks/OLhGhahx.js";import{a as ws,c as ys,d as Ea,s as Hr,e as Ue,i as Yr,p as Ss,S as hr,f as Je,r as kt,b as Tt}from"../chunks/D1pIDgep.js";import{p as Ze,r as Aa,b as Kr,s as xs,a as ks}from"../chunks/BMHL60xN.js";import{a as fa,o as Ts}from"../chunks/CIJjlvtb.js";import{a as $e,d as qr,t as ha,b as gr,o as ga,c as mr,e as Nr,i as ma,f as ba,g as Ps,h as _a,j as Is,k as Gr,m as pr,n as Es,p as As,q as Rs,s as pa,r as Os}from"../chunks/DAJlSe8r.js";import{d as C,c as Ra}from"../chunks/DxF5IDqP.js";import{g as Cs}from"../chunks/BvRNM_vA.js";function zr(a,t,r=!1,s=!1,n=!1){var u=a,S="";V(()=>{var i=ss;if(S===(S=t()??"")){Wr&&va();return}if(i.nodes_start!==null&&(ns(i.nodes_start,i.nodes_end),i.nodes_start=i.nodes_end=null),S!==""){if(Wr){Fr.data;for(var c=va(),d=c;c!==null&&(c.nodeType!==8||c.data!=="");)d=c,c=is(c);if(c===null)throw ls(),os;da(Fr,d),u=us(c);return}var f=S+"";r?f=`<svg>${f}</svg>`:s&&(f=`<math>${f}</math>`);var h=as(f);if((r||s)&&(h=fr(h)),da(fr(h),h.lastChild),r||s)for(;fr(h);)u.before(fr(h));else u.before(h)}})}function Oa(a,t,...r){var s=a,n=Pa,u;cs(()=>{n!==(n=t())&&(u&&(fs(u),u=null),u=vs(()=>n(s,...r)))},ds),Wr&&(s=Fr)}var lt,It,nr,Sr,Ca;const xr=class xr{constructor(t){B(this,Sr);B(this,lt,new WeakMap);B(this,It);B(this,nr);it(this,nr,t)}observe(t,r){var s=m(this,lt).get(t)||new Set;return s.add(r),m(this,lt).set(t,s),Pe(this,Sr,Ca).call(this).observe(t,m(this,nr)),()=>{var n=m(this,lt).get(t);n.delete(r),n.size===0&&(m(this,lt).delete(t),m(this,It).unobserve(t))}}};lt=new WeakMap,It=new WeakMap,nr=new WeakMap,Sr=new WeakSet,Ca=function(){return m(this,It)??it(this,It,new ResizeObserver(t=>{for(var r of t){xr.entries.set(r.target,r);for(var s of m(this,lt).get(r.target)||[])s(r)}}))},oa(xr,"entries",new WeakMap);let Ur=xr;var Ms=new Ur({box:"border-box"});function wa(a,t,r){var s=Ms.observe(a,()=>r(a[t]));hs(()=>(Ia(()=>r(a[t])),s))}function js(a,t,r,s,n){var u=()=>{s(r[a])};r.addEventListener(t,u),u(),(r===document.body||r===window||r===document)&&gs(()=>{r.removeEventListener(t,u)})}function Qt(a){v(a,a.v+1)}const Js=a=>{const t=a*2,r=t>>16&255,s=t>>8&255,n=t&255;return[r,s,n]},qs=([a,t,r])=>{const s=(a<<16|t<<8|r)/2;return s%1?0:s},Ns=["filter","shadowBlur","globalCompositeOperation","globalAlpha","fillStyle","strokeStyle"],zs=(a,t,{rgbToId:r=qs,idToRgb:s=Js}={})=>{const n=a.getContext("2d",t),u=new OffscreenCanvas(a.width,a.height),S=u.getContext("2d",{willReadFrequently:!1,alpha:!1});return new Proxy(n,{get(i,c){const{width:d,height:f}=a;if((d!==u.width||f!==u.height)&&(u.width=d,u.height=f),c==="getLayerIdAt")return(w,b)=>{const[P,L,I]=S.getImageData(w,b,1,1).data;return r([P,L,I])};if(c==="setCurrentLayerId")return w=>{const[b,P,L]=s(w),I=`rgb(${b},${P},${L})`;S.fillStyle=I,S.strokeStyle=I};const h=i[c];return typeof h!="function"?h:(...w)=>{let b=c,P=w;return c==="drawImage"&&(b="fillRect",P=w.slice(-4)),S[b](...P),Reflect.apply(h,i,w)}},set(i,c,d){return i[c]=d,Ns.includes(c)||(S[c]=d),!0}})};var He,Ye,Qe,Et,wr;const Vr=class Vr extends Map{constructor(r){super();B(this,Et);B(this,He,new Map);B(this,Ye,xt(0));B(this,Qe,xt(0));if(r){for(var[s,n]of r)super.set(s,n);m(this,Qe).v=super.size}}has(r){var s=m(this,He),n=s.get(r);if(n===void 0){var u=super.get(r);if(u!==void 0)n=xt(0),s.set(r,n);else return e(m(this,Ye)),!1}return e(n),!0}forEach(r,s){Pe(this,Et,wr).call(this),super.forEach(r,s)}get(r){var s=m(this,He),n=s.get(r);if(n===void 0){var u=super.get(r);if(u!==void 0)n=xt(0),s.set(r,n);else{e(m(this,Ye));return}}return e(n),super.get(r)}set(r,s){var h;var n=m(this,He),u=n.get(r),S=super.get(r),i=super.set(r,s),c=m(this,Ye);if(u===void 0)n.set(r,xt(0)),v(m(this,Qe),super.size),Qt(c);else if(S!==s){Qt(u);var d=c.reactions===null?null:new Set(c.reactions),f=d===null||!((h=u.reactions)!=null&&h.every(w=>d.has(w)));f&&Qt(c)}return i}delete(r){var s=m(this,He),n=s.get(r),u=super.delete(r);return n!==void 0&&(s.delete(r),v(m(this,Qe),super.size),v(n,-1),Qt(m(this,Ye))),u}clear(){if(super.size!==0){super.clear();var r=m(this,He);v(m(this,Qe),0);for(var s of r.values())v(s,-1);Qt(m(this,Ye)),r.clear()}}keys(){return e(m(this,Ye)),super.keys()}values(){return Pe(this,Et,wr).call(this),super.values()}entries(){return Pe(this,Et,wr).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return e(m(this,Qe)),super.size}};He=new WeakMap,Ye=new WeakMap,Qe=new WeakMap,Et=new WeakSet,wr=function(){e(m(this,Ye));var r=m(this,He);if(m(this,Qe).v!==r.size)for(var s of ca(Vr.prototype,this,"keys").call(this))r.has(s)||r.set(s,xt(0));for(var[,n]of m(this,He))e(n)};let ar=Vr;const Ls=a=>{if(window.TouchEvent&&a instanceof TouchEvent){const{left:s,top:n}=a.target.getBoundingClientRect(),{clientX:u,clientY:S}=a.changedTouches[0];return{x:u-s,y:S-n}}const{offsetX:t,offsetY:r}=a;return{x:t,y:r}},ya=(a,t)=>{var r,s;a instanceof MouseEvent&&((r=a.target)==null||r.dispatchEvent(new PointerEvent(`layer.pointer${t}`,a)),(s=a.target)==null||s.dispatchEvent(new MouseEvent(`layer.mouse${t}`,a)))},Ds=["onclick","oncontextmenu","ondblclick","onauxclick","onmousedown","onmouseenter","onmouseleave","onmouseup","onmousemove","onwheel","ontouchstart","ontouchcancel","ontouchend","ontouchmove","onpointerenter","onpointerleave","onpointerdown","onpointerup","onpointermove","onpointercancel","onlayer.mouseenter","onlayer.mouseleave","onlayer.pointerenter","onlayer.pointerleave","onfocus","onblur","onfullscreenchange","onfullscreenerror","onscroll","oncut","oncopy","onpaste","onkeydown","onkeypress","onkeyup","onmouseover","onmouseout","onselect","ondrag","ondragend","ondragenter","ondragstart","ondragleave","ondragover","ondrop","onpointerover","onpointerout","ongotpointercapture","onlostpointercapture"],Ws=a=>console.warn("[svelte-canvas] %s",a),Ma=Symbol("register"),Fs=a=>ms(Ma)(a);var At,Rt,Ot,kr,Tr,ir,pt,qe,Ct,Mt,lr,jt,or,ue,ja,Ja,qa,Na,Xr,za,La;class Hs{constructor(t){B(this,ue);B(this,At,new ar);B(this,Rt,new ar);B(this,Ot,new ar);B(this,kr,1);B(this,Tr,Date.now());B(this,ir,T(0));B(this,pt);B(this,qe);B(this,Ct);B(this,Mt);B(this,lr,T(be([])));B(this,jt,T(0));B(this,or,re(()=>m(this,Ot).get(e(m(this,jt)))));it(this,qe,t),bs(Ma,this.register.bind(this))}init(t,r){it(this,pt,t),Pe(this,ue,Na).call(this,r),Ke(()=>Pe(this,ue,Xr).call(this)),Ke(()=>Pe(this,ue,qa).call(this)),Ke(()=>(e(m(this,ir)),Pe(this,ue,za).call(this))),fa(()=>Pe(this,ue,La).call(this))}redraw(){_s(m(this,ir))}register({setup:t,render:r,...s}){const n=Pe(this,ue,ja).call(this);return t&&m(this,At).set(n,t),m(this,Rt).set(n,r),Object.keys(s).length&&(m(this,qe).layerEvents?m(this,Ot).set(n,s):Ws("Canvas must have layerEvents={true} in order to use layer-level event handlers")),fa(()=>Pe(this,ue,Ja).call(this,n)),n}createEventHandlers(){const t=n=>{const u=`on${n.type}`,S=m(this,qe).handlers[u];S==null||S(n)},r=n=>{const{pixelRatio:u}=m(this,qe),{x:S,y:i}=Ls(n);if(["touchstart","pointermove"].includes(n.type)){const f=m(this,pt).getLayerIdAt(S*u,i*u);e(m(this,jt))!==f&&(ya(n,"leave"),v(m(this,jt),f,!0),ya(n,"enter"))}if(!e(m(this,or)))return;const c=`on${n.type.replace("layer.","")}`,d=e(m(this,or))[c];d==null||d({x:S,y:i,originalEvent:n})},s=n=>{t(n),m(this,qe).layerEvents&&r(n)};return Ds.reduce((n,u)=>({...n,[u]:s}),{})}}At=new WeakMap,Rt=new WeakMap,Ot=new WeakMap,kr=new WeakMap,Tr=new WeakMap,ir=new WeakMap,pt=new WeakMap,qe=new WeakMap,Ct=new WeakMap,Mt=new WeakMap,lr=new WeakMap,jt=new WeakMap,or=new WeakMap,ue=new WeakSet,ja=function(){return ua(this,kr)._++},Ja=function(t){m(this,Rt).delete(t),m(this,Ot).delete(t)},qa=function(){const{onresize:t,width:r,height:s,pixelRatio:n}=m(this,qe);t==null||t({width:r,height:s,pixelRatio:n})},Na=function(t){const r=()=>{const s=[...t.children];v(m(this,lr),s.map(n=>+n.dataset.layerId),!0)};it(this,Mt,new MutationObserver(()=>r())),m(this,Mt).observe(t,{childList:!0}),r()},Xr=function(){m(this,qe).autoplay?(Ia(()=>this.redraw()),it(this,Ct,requestAnimationFrame(()=>Pe(this,ue,Xr).call(this)))):cancelAnimationFrame(m(this,Ct))},za=function(){var c,d,f;const t=m(this,pt),{width:r,height:s,pixelRatio:n,autoclear:u}=m(this,qe),S=Date.now()-m(this,Tr),i={context:t,width:r,height:s,time:S};t.setTransform(n,0,0,n,0,0),u&&t.clearRect(0,0,r,s);for(const[h,w]of m(this,At))w(i),m(this,At).delete(h);for(const h of e(m(this,lr)))(d=(c=m(this,pt)).setCurrentLayerId)==null||d.call(c,h),(f=m(this,Rt).get(h))==null||f(i)},La=function(){var t;typeof window>"u"||((t=m(this,Mt))==null||t.disconnect(),cancelAnimationFrame(m(this,Ct)))};/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Ys(a,t){var r=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(r!=null){var s,n,u,S,i=[],c=!0,d=!1;try{if(u=(r=r.call(a)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(s=u.call(r)).done)&&(i.push(s.value),i.length!==t);c=!0);}catch(f){d=!0,n=f}finally{try{if(!c&&r.return!=null&&(S=r.return(),Object(S)!==S))return}finally{if(d)throw n}}return i}}function Sa(a,t){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),r.push.apply(r,s)}return r}function Ie(a){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sa(Object(r),!0).forEach(function(s){Ks(a,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Sa(Object(r)).forEach(function(s){Object.defineProperty(a,s,Object.getOwnPropertyDescriptor(r,s))})}return a}function Ks(a,t,r){return t=en(t),t in a?Object.defineProperty(a,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[t]=r,a}function Us(a,t){if(a==null)return{};var r={},s=Object.keys(a),n,u;for(u=0;u<s.length;u++)n=s[u],!(t.indexOf(n)>=0)&&(r[n]=a[n]);return r}function Xs(a,t){if(a==null)return{};var r=Us(a,t),s,n;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(a);for(n=0;n<u.length;n++)s=u[n],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(a,s)&&(r[s]=a[s])}return r}function xa(a,t){return Gs(a)||Ys(a,t)||Da(a,t)||Zs()}function br(a){return Bs(a)||Vs(a)||Da(a)||Qs()}function Bs(a){if(Array.isArray(a))return Br(a)}function Gs(a){if(Array.isArray(a))return a}function Vs(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Da(a,t){if(a){if(typeof a=="string")return Br(a,t);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Br(a,t)}}function Br(a,t){(t==null||t>a.length)&&(t=a.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=a[r];return s}function Qs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zs(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $s(a,t){if(typeof a!="object"||a===null)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var s=r.call(a,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(a)}function en(a){var t=$s(a,"string");return typeof t=="symbol"?t:String(t)}function sr(a){var t=a.sizes.shift(),r=Math.max(Math.ceil(t[0]),1),s=Math.max(Math.ceil(t[1]),1),n=[r-1,s-1,1,1],u=Date.now(),S=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,i,c;S?(i=new OffscreenCanvas(1,1),c=new OffscreenCanvas(r,s)):(i=document.createElement("canvas"),i.width=1,i.height=1,c=document.createElement("canvas"),c.width=r,c.height=s);var d=i.getContext("2d"),f=c.getContext("2d");f&&(f.fillRect.apply(f,n),d.drawImage(c,r-1,s-1,1,1,0,0,1,1));var h=d&&d.getImageData(0,0,1,1).data[3]!==0,w=Date.now()-u;return[i,c].forEach(function(b){b.height=0,b.width=0}),S?(postMessage({width:r,height:s,benchmark:w,isTestPass:h}),!h&&a.sizes.length&&sr(a)):h?a.onSuccess(r,s,w):(a.onError(r,s,w),a.sizes.length&&sr(a)),h}var Lr={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},tn=["onError","onSuccess"],Pt={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Zt={};function Dr(a){var t=a.width===a.height,r=a.height===1,s=a.width===1,n=[];if(!a.width||!a.height)a.sizes.forEach(function(f){var h=t||r?f:1,w=t||s?f:1;n.push([h,w])});else for(var u=a.min||Pt.min,S=a.step||Pt.step,i=Math.max(a.width,a.height);i>=u;){var c=t||r?i:1,d=t||s?i:1;n.push([c,d]),i-=S}return n}function _r(a){var t=window&&"HTMLCanvasElement"in window,r=window&&"OffscreenCanvas"in window,s=Date.now(),n=a.onError,u=a.onSuccess,S=Xs(a,tn),i=null;if(!t)return!1;if(a.useWorker&&r){var c=`
            var canvasTest = `.concat(sr.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),d=new Blob([c],{type:"application/javascript"}),f=URL.createObjectURL(d);i=new Worker(f),URL.revokeObjectURL(f),i.onmessage=function(h){var w=h.data,b=w.width,P=w.height,L=w.benchmark,I=w.isTestPass;I?(Zt[s].onSuccess(b,P,L),delete Zt[s]):Zt[s].onError(b,P,L)}}if(a.usePromise)return new Promise(function(h,w){var b=Ie(Ie({},a),{},{onError:function(j,J,D){var z;if(a.sizes.length===0)z=!0;else{var X=a.sizes.slice(-1),K=xa(X,1),_e=xa(K[0],2),Ne=_e[0],et=_e[1];z=j===Ne&&J===et}n(j,J,D),z&&w({width:j,height:J,benchmark:D})},onSuccess:function(j,J,D){u(j,J,D),h({width:j,height:J,benchmark:D})}});if(i){var P=b.onError,L=b.onSuccess;Zt[s]={onError:P,onSuccess:L},i.postMessage(S)}else sr(b)});if(i)Zt[s]={onError:n,onSuccess:u},i.postMessage(S);else return sr(a)}var rn={maxArea:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Dr({width:t.max,height:t.max,min:t.min,step:t.step,sizes:br(Lr.area)}),s=Ie(Ie(Ie({},Pt),t),{},{sizes:r});return _r(s)},maxHeight:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Dr({width:1,height:t.max,min:t.min,step:t.step,sizes:br(Lr.height)}),s=Ie(Ie(Ie({},Pt),t),{},{sizes:r});return _r(s)},maxWidth:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Dr({width:t.max,height:1,min:t.min,step:t.step,sizes:br(Lr.width)}),s=Ie(Ie(Ie({},Pt),t),{},{sizes:r});return _r(s)},test:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Ie(Ie({},Pt),t);return r.sizes=br(r.sizes),r.width&&r.height&&(r.sizes=[[r.width,r.height]]),_r(r)}};const an=(a,t,r,s=.1)=>{if(typeof window>"u")return r;for(;!rn.test({sizes:[[a*r,t*r]]});)r-=s;return r};var sn=M("<canvas></canvas> <div><!></div>",1);function nn(a,t){ot(t,!0);let r=Ze(t,"style",3,""),s=Ze(t,"autoplay",3,!1),n=Ze(t,"autoclear",3,!0),u=Ze(t,"layerEvents",3,!1),S=Aa(t,["$$slots","$$events","$$legacy","width","height","pixelRatio","class","style","autoplay","autoclear","layerEvents","onresize","contextSettings","children"]),i,c,d,f=T(2),h=T(0),w=T(0);const b=re(()=>t.width??e(h)),P=re(()=>t.height??e(w)),L=re(()=>e(f)&&t.pixelRatio==="auto"?an(e(b),e(P),e(f)):t.pixelRatio&&t.pixelRatio!=="auto"?t.pixelRatio:e(f)),I=new Hs({get width(){return e(b)},get height(){return e(P)},get pixelRatio(){return e(L)},get autoplay(){return s()},get autoclear(){return n()},get layerEvents(){return u()},get onresize(){return t.onresize},handlers:S});Ts(()=>{u()?c=zs(i,t.contextSettings):c=i.getContext("2d",t.contextSettings),I.init(c,d)});const j=()=>I.redraw();var J=sn(),D=fe(J);ws(D,K=>({class:t.class,width:e(b)*e(L),height:e(P)*e(L),style:r(),...K,[ys]:{width:t.width?`${t.width}px`:"100%",height:t.height?`${t.height}px`:"100%"}}),[()=>I.createEventHandlers()]),Kr(D,K=>i=K,()=>i);var z=x(D,2);Ea(z,"",{},{display:"none"});var X=p(z);return Oa(X,()=>t.children??Pa),g(z),Kr(z,K=>d=K,()=>d),js("devicePixelRatio","resize",tr,K=>v(f,K,!0)),wa(D,"clientWidth",K=>v(h,K)),wa(D,"clientHeight",K=>v(w,K)),k(a,J),ut({redraw:j,get canvas(){return i},set canvas(K){i=K},get context(){return c},set context(K){c=K}})}var ln=M("<div></div>");function on(a,t){ot(t,!0);const r=Aa(t,["$$slots","$$events","$$legacy"]),s=Fs(r);var n=ln();V(()=>Hr(n,"data-layer-id",s)),k(a,n),ut()}var un=M("<div><!> <!></div>");function cn(a,t){ot(t,!0);const r=()=>window.performance.now();let s=Ze(t,"highlighted",19,()=>[]),n=Ze(t,"disabled",19,()=>[]),u=Ze(t,"highlightJewels",3,!1);const S=[427,320,226,227,323,422,329],i="25px Roboto Mono",c="17px Roboto Mono";let d=T(10),f=T(0),h=T(0),w=re(()=>Is/e(d));const b=2.6,P={},L={},I=(o,F,se,$=!1,ie=!1)=>{let Q=$?Ps[F]:_a[F];!Q&&$&&(Q=_a[F]);const le=Q.filename;le in($?L:P)||(($?L:P)[le]=new Image,($?L:P)[le].src=le);const ae=Q.coords[F],ze=ae.w/e(d)*b,je=ae.h/e(d)*b,O=se.x-ze/2,y=se.y-je/2;let H=y;ie&&(H=y-je/2),o.drawImage(($?L:P)[le],ae.x,ae.y,ae.w,ae.h,O,H,ze,je),ie&&(o.save(),o.translate(O,y),o.rotate(Math.PI),o.drawImage(($?L:P)[le],ae.x,ae.y,ae.w,ae.h,-ze,-(je/2),ze,-je),o.restore())},j=(o,F,se)=>{const $=[];let ie="";return o.split(" ").forEach(Q=>{F.measureText(ie+Q).width<se?ie+=" "+Q:($.push(ie.trim()),ie=Q)}),ie.length>0&&$.push(ie.trim()),$};let J=T(be({x:Number.MIN_VALUE,y:Number.MIN_VALUE})),D=T("unset"),z=T(void 0),X=re(()=>({context:o,width:F,height:se})=>{var je;const $=window.performance.now();o.clearRect(0,0,F,se),o.fillStyle="#080c11",o.fillRect(0,0,F,se);const ie={};Object.keys(qr).forEach(O=>{const y=parseInt(O),H=qr[y],Y=ha(H.x,H.y,e(f),e(h),e(d)),ce=Math.max(...H.orbits);S.indexOf(y)>=0||(ce==1?I(o,"PSGroupBackground1",Y,!1):ce==2?I(o,"PSGroupBackground2",Y,!1):(ce==3||H.orbits.length>1)&&I(o,"PSGroupBackground3",Y,!1,!0))}),Object.entries(gr).forEach(([O,y])=>{var Le;const H=parseInt(O);if(!y)return;const Y=ga(y.orbit??0,y.orbitIndex??0),ce=mr(y,e(f),e(h),e(d));(Le=y.out)==null||Le.forEach(pe=>{const Xe=parseInt(pe),U=gr[Xe];if(!U)return;const Be=Math.min(Xe,H),de=Math.max(Xe,H),l=Be+":"+de;if(l in ie||(ie[l]=!0,!U)||U.isMastery)return;const E=ga(U.orbit??0,U.orbitIndex??0),_=mr(U,e(f),e(h),e(d));if(o.beginPath(),y.group!=U.group||y.orbit!=U.orbit)o.moveTo(ce.x,ce.y),o.lineTo(_.x,_.y);else{let A=Math.PI/180-Math.PI/180*Y,R=Math.PI/180-Math.PI/180*E;A-=Math.PI/2,R-=Math.PI/2;const W=Math.abs(Math.max(A,R)-Math.min(A,R)),ee=W>Math.PI?Math.max(A,R):Math.min(A,R),te=W>Math.PI?Math.min(A,R):Math.max(A,R);if(!y.group)return;const ve=qr[y.group];if(!ve)return;const he=ha(ve.x,ve.y,e(f),e(h),e(d));o.arc(he.x,he.y,$e.constants.orbitRadii[y.orbit??0]/e(d)+1,ee,te)}o.lineWidth=6/e(d),o.strokeStyle="#524518",o.stroke()})});let Q={x:0,y:0};t.circledNode&&(Q=mr(gr[t.circledNode],e(f),e(h),e(d)),o.strokeStyle="#ad2b2b");let le=!1,ae;if(Object.values(gr).forEach(O=>{const y=mr(O,e(f),e(h),e(d));let H=0,Y=!1;t.circledNode&&Nr(y,Q)<e(w)&&(Y=!0),O.skill&&n().indexOf(O.skill)>=0&&(Y=!1),O.isKeystone?(H=110,I(o,O.icon??"",y,Y),Y?I(o,"KeystoneFrameAllocated",y,!1):I(o,"KeystoneFrameUnallocated",y,!1)):O.isNotable?(H=70,I(o,O.icon??"",y,Y),Y?I(o,"NotableFrameAllocated",y,!1):I(o,"NotableFrameUnallocated",y,!1)):O.isJewelSocket?(H=70,O.expansionJewel?I(o,"JewelSocketAltNormal",y,!1):Y?I(o,"JewelFrameAllocated",y,!1):I(o,"JewelFrameUnallocated",y,!1)):O.isMastery?I(o,O.inactiveIcon??"",y,Y):(H=50,I(o,O.icon??"",y,Y),Y?I(o,"PSSkillFrameActive",y,!1):I(o,"PSSkillFrame",y,!1)),(s().indexOf(O.skill??-1)>=0||u()&&O.isJewelSocket)&&(o.strokeStyle="#00ff00",o.lineWidth=3,o.beginPath(),o.arc(y.x,y.y,(H+30)/e(d),0,Math.PI*2),o.stroke()),Nr(y,e(J))<H/e(d)&&(ae=O,le=Y,console.log("Hovering over node:",O.skill,O.name,"at distance:",Nr(y,e(J)),"touchDistance:",H/e(d)))}),v(z,ae,!0),t.circledNode&&(o.strokeStyle="#ad2b2b",o.lineWidth=1,o.beginPath(),o.arc(Q.x,Q.y,e(w),0,Math.PI*2),o.stroke()),e(z)){let O=e(z).name??"Node name",y=(e(z).stats||[]).map(U=>({text:U,special:!1}));if(!e(z).isJewelSocket&&le&&e(z).skill!==void 0&&(je=C)!=null&&je.TreeToPassive&&C.TreeToPassive[e(z).skill]!==void 0&&t.seed&&t.selectedJewel&&t.selectedConqueror){const U=e(z).skill,Be=C.TreeToPassive[U];if(Be&&Be.Index!==void 0){const de=Ra.Calculate(Be.Index,t.seed,t.selectedJewel,t.selectedConqueror);if(de)"AlternatePassiveSkill"in de&&de.AlternatePassiveSkill&&(y=[],O=de.AlternatePassiveSkill.Name??"Alternative Skill",de.AlternatePassiveSkill.StatsKeys&&(de.AlternatePassiveSkill.StatsKeys.forEach((l,E)=>{const _=C.GetStatByIndex(l);if(!_)return;const A=ma[_.ID]||"";if(A&&de.StatRolls&&de.StatRolls[E]!==void 0)y.push({text:ba(A,de.StatRolls[E])||_.ID,special:!0});else throw new Error(`Failed to translate ${O}. Skill ID: ${U}, Stat ID: ${_.ID}`)}),de.AlternatePassiveAdditionInformations&&de.AlternatePassiveAdditionInformations.forEach(l=>{l.AlternatePassiveAddition&&l.AlternatePassiveAddition.StatsKeys&&l.AlternatePassiveAddition.StatsKeys.forEach((E,_)=>{const A=C.GetStatByIndex(E);if(!A)return;const R=ma[A.ID]||"";if(R&&l.StatRolls&&l.StatRolls[_]!==void 0)y.push({text:ba(R,l.StatRolls[_])||A.ID,special:!0});else throw new Error(`Failed to translate ${O} additional info for statID: ${A.ID}, skillID: ${U}, statRoll: ${l.StatRolls?l.StatRolls[_]:"undefined"}`)})})));else throw new Error(`Failed to calculate ${O}. Skill ID: ${U}, Seed: ${t.seed}, Selected Jewel: ${t.selectedJewel}, Selected Conqueror: ${t.selectedConqueror}`)}}o.font=i;const H=o.measureText(O),Y=Math.max(H.width+50,600);o.font=c;const ce=[],Le=30;let pe=85;y&&y.length>0?y.forEach(U=>{ce.length>0&&(pe+=5),U.text.split(`
`).forEach(Be=>{ce.length>0&&(pe+=10),j(Be,o,Y-Le).forEach(l=>{ce.push({text:l,offset:pe,special:U.special}),pe+=20})})}):e(z).isJewelSocket&&(ce.push({text:"Click to select this socket",offset:pe,special:!0}),pe+=20);const Xe=55;o.fillStyle="rgba(75,63,24,0.9)",o.fillRect(e(J).x,e(J).y,Y,Xe),o.fillStyle="#ffffff",o.font=i,o.textAlign="center",o.fillText(O,e(J).x+Y/2,e(J).y+35),o.fillStyle="rgba(0,0,0,0.8)",o.fillRect(e(J).x,e(J).y+Xe,Y,pe-Xe),o.font=c,o.textAlign="left",ce.forEach(U=>{U.special?o.fillStyle="#8cf34c":o.fillStyle="#ffffff",o.fillText(U.text,e(J).x+Le/2,e(J).y+U.offset)})}e(z)&&e(z).isJewelSocket?v(D,"pointer"):v(D,"unset"),o.fillStyle="#ffffff",o.textAlign="right",o.font="12px Roboto Mono";const ze=r();o.fillText(`${(ze-$).toFixed(1)}ms`,F-5,17)}),K=T(0),_e=T(0),Ne=T(0),et=T(0),ct=T(!1);const Pr=o=>{v(ct,!0),v(K,o.offsetX,!0),v(_e,o.offsetY,!0),v(Ne,e(f),!0),v(et,e(h),!0),v(J,{x:o.offsetX,y:o.offsetY},!0),e(z)&&t.clickNode(e(z))},Ir=o=>{o.type==="pointerup"&&v(ct,!1),v(J,{x:o.offsetX,y:o.offsetY},!0)},Er=o=>{e(ct)&&(v(f,e(Ne)-(e(K)-o.offsetX)*e(d)),v(h,e(et)-(e(_e)-o.offsetY)*e(d))),v(J,{x:o.offsetX,y:o.offsetY},!0)},Oe=o=>{const F=o;F.deltaY>0?e(d)<30&&(v(f,e(f)+F.offsetX),v(h,e(h)+F.offsetY)):e(d)>3&&(v(f,e(f)-F.offsetX),v(h,e(h)-F.offsetY)),v(d,Math.min(30,Math.max(3,e(d)+F.deltaY/100)),!0),o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation()};let dt=T(0),vt=T(0);const Ce=()=>{v(dt,window.innerWidth,!0),v(vt,window.innerHeight,!0)};let Jt=T(!1);Ke(()=>{!e(Jt)&&$e&&(v(Jt,!0),v(f,$e.min_x+window.innerWidth/2*e(d)),v(h,$e.min_y+window.innerHeight/2*e(d)))}),Ke(()=>{Ce()});var Me=yr();rr("pointerup",tr,Ir),rr("pointermove",tr,Er),rr("resize",tr,Ce);var qt=fe(Me);{var Nt=o=>{var F=un(),se=p(F);nn(se,{get width(){return e(dt)},get height(){return e(vt)},onpointerdown:Pr,onwheel:Oe,children:(Q,le)=>{on(Q,{get render(){return e(X)}})},$$slots:{default:!0}});var $=x(se,2);{var ie=Q=>{var le=yr(),ae=fe(le);Oa(ae,()=>t.children),k(Q,le)};G($,Q=>{t.children&&Q(ie)})}g(F),V(()=>Ea(F,`touch-action: none; cursor: ${e(D)??""}`)),k(o,F)};G(qt,o=>{e(dt)&&e(vt)&&o(Nt)})}k(a,Me),ut()}const ka=(a,t)=>t.highlight(t.set.seed,t.set.skills.map(r=>r.passive));var dn=(a,t)=>Gr(Es(t.jewel,t.conqueror,t.set)),vn=M("<li> </li>"),fn=M('<div class="mt-2"><span> </span> <ul class="list-disc pl-6 font-bold"></ul></div>'),hn=M('<div class="my-2 border-white/50 border p-2 flex flex-col cursor-pointer" role="button" tabindex="0"><div class="flex flex-row justify-between"><button class="px-3 invisible">Trade</button> <div class="font-bold text-orange-500 text-center"> </div> <button class="px-3 bg-blue-500/40 rounded">Trade</button></div> <!></div>');function Ta(a,t){ot(t,!0);var r=hn();r.__click=[ka,t],r.__keydown=[ka,t];var s=p(r),n=x(p(s),2),u=p(n);g(n);var S=x(n,2);S.__click=[dn,t],g(s);var i=x(s,2);Ue(i,17,()=>t.set.skills,c=>c.passive,(c,d)=>{var f=fn(),h=p(f),w=p(h);g(h);var b=x(h,2);Ue(b,20,()=>Object.keys(e(d).stats),P=>P,(P,L)=>{var I=vn(),j=p(I,!0);g(I),V(J=>Re(j,J),[()=>pr(parseInt(L),e(d).stats[L])]),k(P,I)}),g(b),g(f),V(()=>Re(w,`${$e.nodes[e(d).passive].name??""} (${e(d).passive??""})`)),k(c,f)}),g(r),V(()=>Re(u,`Seed ${t.set.seed??""} (weight ${t.set.weight??""}) Stat Total: ${t.set.statTotal??""}`)),k(a,r),ut()}ur(["click","keydown"]);var gn=(a,t,r)=>e(t)===String(r)?v(t,""):v(t,String(r),!0),mn=M("<div><!></div>"),bn=M('<div class="flex flex-col overflow-auto min-h-[200px] mb-2"></div>'),_n=M('<button class="text-lg w-full p-2 px-4 rounded flex flex-row justify-between mb-2" style="background-color: rgba(107, 114, 128, 0.3);"><span> </span> <span> </span></button> <!>',1),pn=M('<div class="flex flex-col overflow-auto"></div>'),wn=M("<div><!></div>"),yn=M('<div class="mt-4 flex flex-col overflow-auto"></div>');function Sn(a,t){ot(t,!0);let r=Ze(t,"groupResults",3,!0),s=T("");var n=yr(),u=fe(n);{var S=c=>{var d=pn();Ue(d,20,()=>Object.keys(t.searchResults.grouped).map(f=>parseInt(f,10)).sort((f,h)=>f-h).reverse(),f=>f,(f,h)=>{var w=_n(),b=fe(w);b.__click=[gn,s,h];var P=p(b),L=p(P);g(P);var I=x(P,2),j=p(I,!0);g(I),g(b);var J=x(b,2);{var D=z=>{var X=bn();Ue(X,21,()=>t.searchResults.grouped[h],Yr,(K,_e)=>{var Ne=mn(),et=p(Ne);Ta(et,{get set(){return e(_e)},get highlight(){return t.highlight},get jewel(){return t.jewel},get conqueror(){return t.conqueror}}),g(Ne),k(K,Ne)}),g(X),k(z,X)};G(J,z=>{e(s)===String(h)&&z(D)})}V(z=>{Re(L,`${h??""} Match${h>1?"es":""} [${t.searchResults.grouped[h].length??""}]`),Re(j,z)},[()=>e(s)===String(h)?"^":"V"]),k(f,w)}),g(d),k(c,d)},i=c=>{var d=yn();Ue(d,21,()=>t.searchResults.raw,Yr,(f,h)=>{var w=wn(),b=p(w);Ta(b,{get set(){return e(h)},get highlight(){return t.highlight},get jewel(){return t.jewel},get conqueror(){return t.conqueror}}),g(w),k(f,w)}),g(d),k(c,d)};G(u,c=>{r()?c(S):c(i,!1)})}k(a,n),ut()}ur(["click"]);const $t={25:1,26:1,42:1,49:1,56:1,63:1,70:2,95:4,117:1,124:4,134:1,150:2,216:1,434:1,482:1,483:1,484:1,488:1,554:1,556:1,593:3,594:3,595:3,619:1,943:1,944:1,945:1,946:1,2133:4,3108:3,3109:4,3110:4,3111:4,5815:4,8835:1,9091:1,9772:1,14775:2,209:1,447:1,573:2,1294:1,1361:1,2031:5,8177:2,448:2,486:1,579:2,1404:1,2030:5,9090:1,9711:2,9712:2,9713:2,9714:2,9716:1,9717:1,9718:1,9721:1,9722:1,9723:1,9724:1,186:2,490:1,1251:3,1654:1,3392:1,6042:1,6048:1,6049:1,6050:1,6136:1,7499:2},xn=(a,t,r,s)=>{t.queries.length===1?Gr(t.queries[0]):e(r)&&s(!s())};var kn=M('<button class="p-1 px-3 bg-blue-500/40 rounded disabled:bg-blue-900/40 mr-2"><!></button>');function Tn(a,t){ot(t,!0);let r=Ze(t,"showTradeLinks",15,!1),s=re(()=>t.queries.length>1);var n=kn();n.__click=[xn,t,s,r];var u=p(n);{var S=c=>{var d=yr(),f=fe(d);{var h=b=>{var P=er("Hide Trade Links");k(b,P)},w=b=>{var P=er("Show Trade Links");k(b,P)};G(f,b=>{r()?b(h):b(w,!1)})}k(c,d)},i=c=>{var d=er("Trade");k(c,d)};G(u,c=>{e(s)?c(S):c(i,!1)})}g(n),V(()=>n.disabled=!t.queries),k(a,n),ut()}ur(["click"]);var Pn=(a,t)=>Gr(e(t)),In=M('<button class="p-1 px-3 bg-blue-500/40 rounded"></button>'),En=M('<div class="flex flex-wrap gap-2.5 my-2"></div>');function An(a,t){ot(t,!0);var r=En();Ue(r,21,()=>t.queries,Yr,(s,n,u)=>{var S=In();S.__click=[Pn,n],S.textContent=`Trade Batch ${u+1}`,k(s,S)}),g(r),k(a,r),ut()}ur(["click"]);const Rn=(a,t)=>{t.clear()},On=(a,t,r)=>{e(t).forEach(s=>{s.isNotable&&r.delete(s.skill)})},Cn=(a,t,r)=>{e(t).forEach(s=>{s.isNotable||r.delete(s.skill)})},Mn=(a,t,r)=>{e(t).filter(s=>!s.isJewelSocket&&!s.isMastery).forEach(s=>r.add(s.skill))};var jn=(a,t)=>v(t,!0),Jn=M("<span>Results</span>"),qn=M("<span>Timeless Jewel</span>"),Nn=(a,t)=>v(t,!e(t)),zn=M("<!> <button>Grouped</button>",1),Ln=(a,t)=>v(t,!e(t)),Dn=M('<div class="flex flex-row"><!> <button class="bg-neutral-100/20 px-4 p-1 rounded"> </button></div>'),Wn=(a,t)=>t("seed"),Fn=(a,t)=>t("stats"),Hn=M('<div class="mt-2"> </div>'),Yn=(a,t)=>v(t,!e(t)),Kn=(a,t)=>v(t,!e(t)),Un=(a,t,r,s)=>t(e(r),e(s).passives),Xn=(a,t,r,s)=>a.key==="Enter"&&t(e(r),e(s).passives),Bn=M('<li><button class="cursor-pointer w-full text-left"><span> </span> <span class="text-white"><!></span></button></li>'),Gn=M("<ul></ul>"),Vn=(a,t,r,s)=>t(e(r),e(s).passives),Qn=(a,t,r,s)=>a.key==="Enter"&&t(e(r),e(s).passives),Zn=M('<li><button class="cursor-pointer w-full text-left"><span> </span> <span class="text-white"><!></span></button></li>'),$n=(a,t,r,s)=>t(e(r),e(s).passives),ei=(a,t,r,s)=>a.key==="Enter"&&t(e(r),e(s).passives),ti=M('<li><button class="cursor-pointer w-full text-left"><span> </span> <span class="text-white"><!></span></button></li>'),ri=M('<div class="overflow-auto mt-4"><h3>Notables</h3> <ul></ul><h3 class="mt-2">Smalls</h3> <ul></ul></div>'),ai=M('<div class="flex flex-row mt-4 items-end"><div class="flex-grow"><h3 class="mb-2">Sort Order</h3> <!></div> <div class="ml-2"><button>Colors</button></div> <div class="ml-2"><button>Split</button></div></div> <!>',1),si=M('<div class="mt-4"><h3 class="mb-2">Seed</h3> <input type="number"/> <!></div> <!>',1),ni=(a,t,r,s)=>t(e(r)[parseInt(s)].id),ii=M('<div class="mb-4 flex flex-row items-start flex-col border-neutral-100/40 border-b pb-4"><div><button class="p-2 px-4 bg-red-500/40 rounded mr-2">-</button> <span> </span></div> <div class="mt-2 flex flex-row"><div class="mr-4 flex flex-row items-center"><div class="mr-2">Min:</div> <input type="number" min="0"/></div> <div class="flex flex-row items-center"><div class="mr-2">Weight:</div> <input type="number" min="0"/></div> <div class="flex flex-row items-center"><div class="mr-2">Minimum Stat Total:</div> <input type="number" min="0"/></div></div></div>'),li=(a,t)=>t(),oi=M('<div class="mt-4 flex flex-col overflow-auto min-h-[100px]"></div> <div class="flex flex-col mt-2"><div class="flex flex-row items-center"><div class="mr-2 min-w-fit">Min Total Weight:</div> <input type="number" min="0"/></div> <div class="flex flex-row items-center"><div class="mr-2 min-w-fit">Minimum Stat Total:</div> <input type="number" min="0"/></div></div> <div class="flex flex-col mt-4"><div class="flex flex-row"><button class="p-2 px-2 bg-yellow-500/40 rounded disabled:bg-yellow-900/40 mr-2">Select All</button> <button class="p-2 px-2 bg-yellow-500/40 rounded disabled:bg-yellow-900/40 mr-2">Notables</button> <button class="p-2 px-2 bg-yellow-500/40 rounded disabled:bg-yellow-900/40 mr-2">Passives</button> <button class="p-2 px-2 bg-yellow-500/40 rounded disabled:bg-yellow-900/40 flex-grow">Deselect</button></div> <div class="flex flex-row mt-2"><button class="p-2 px-3 bg-green-500/40 rounded disabled:bg-green-900/40 flex-grow"><!></button></div></div>',1),ui=M('<div class="mt-4"><h3 class="mb-2">Add Stat</h3> <!></div> <!>',1),ci=M('<h2 class="mt-4">Click on a jewel socket</h2>'),di=M('<div class="mt-4 w-full flex flex-row"><button>Enter Seed</button> <button>Select Stats</button></div> <!> <!>',1),vi=M('<div class="mt-4"><h3 class="mb-2">Conqueror</h3> <!></div> <!>',1),fi=M("<!> <!>",1),hi=M("<!> <!>",1),gi=M('<div class="w-screen md:w-10/12 lg:w-2/3 xl:w-1/2 2xl:w-5/12 3xl:w-1/3 4xl:w-1/4 absolute top-0 left-0 bg-black/80 backdrop-blur-sm themed rounded-br-lg max-h-screen"><div class="p-4 max-h-screen flex flex-col"><div class="flex flex-row justify-between mb-2"><div class="flex flex-row items-center"><button class="burger-menu mr-3" aria-label="Collapse menu"><div></div> <div></div> <div></div></button> <h3 class="flex-grow"><!></h3></div> <!></div> <!> <!></div></div>'),mi=(a,t)=>v(t,!1),bi=M('<button class="burger-menu absolute top-0 left-0 bg-black/80 backdrop-blur-sm rounded-br-lg p-4 pt-5" aria-label="Expand menu"><div></div> <div></div> <div></div></button>'),_i=M('<!> <div class="text-orange-500 absolute bottom-0 right-0 m-2"><a href="https://github.com/BlazesRus/timeless-jewels" target="_blank" rel="noopener noreferrer">Source (Github)</a></div>',1);function Ri(a,t){ot(t,!0);const[r,s]=ks(),u=xs(Ss,"$page",r).url.searchParams,S=Object.keys(C.TimelessJewels||{}).map(l=>{var E;return{value:parseInt(l),label:((E=C.TimelessJewels)==null?void 0:E[parseInt(l)])||l}});let i=T(be(u.has("jewel")?S.find(l=>l.value==parseInt(u.get("jewel")||"0")):void 0)),c=re(()=>e(i)&&C.TimelessJewelConquerors?Object.keys(C.TimelessJewelConquerors[e(i).value]||{}).map(l=>({value:l,label:l})):[]),d=re(()=>e(c).concat([{value:"Any",label:"Any"}])),f=T(be(u.has("conqueror")?{value:u.get("conqueror"),label:u.get("conqueror")}:void 0)),h=re(()=>{var l;return((l=e(f))==null?void 0:l.value)==="Any"}),w=re(()=>{var l;return((l=e(f))==null?void 0:l.value)==="Any"?e(c)[0]:e(f)}),b=T(be(u.has("seed")?parseInt(u.get("seed")||"0"):0)),P=T(be(u.has("location")?parseInt(u.get("location")||"0"):void 0)),L=re(()=>e(P)?Rs($e.nodes[e(P)]).filter(l=>!l.isJewelSocket&&!l.isMastery):[]),I=re(()=>!e(b)||!e(i)||!e(w)||!C.TimelessJewelConquerors||!C.TimelessJewelConquerors[e(i).value]||!e(w).value||Object.keys(C.TimelessJewelConquerors[e(i).value]||{}).indexOf(e(w).value)<0?[]:e(L).filter(l=>l.skill!==void 0&&C.TreeToPassive&&C.TreeToPassive[l.skill]).map(l=>{var E,_,A,R;return{node:l.skill,result:Ra.Calculate(((_=(E=C.TreeToPassive)==null?void 0:E[l.skill])==null?void 0:_.Index)||0,e(b),((A=e(i))==null?void 0:A.value)||0,((R=e(w))==null?void 0:R.value)||"")}})),j=T(be({}));u.has("stat")&&u.getAll("stat").forEach(l=>{const E=parseInt(l);e(j)[E]={weight:1,min:0,id:E,minStatTotal:0}});let J=T(be(u.has("mode")?u.get("mode"):""));const D=()=>{var E;const l=new URL(window.location.origin+window.location.pathname);e(i)&&l.searchParams.append("jewel",e(i).value.toString()),(E=e(f))!=null&&E.value&&l.searchParams.append("conqueror",e(f).value),e(b)&&l.searchParams.append("seed",e(b).toString()),e(P)&&l.searchParams.append("location",e(P).toString()),e(J)&&l.searchParams.append("mode",e(J)),Object.keys(e(j)).forEach(_=>{l.searchParams.append("stat",_.toString())}),Cs(l.toString())},z=l=>{v(J,l,!0),D()};let X=be(new Set);const K=l=>{l.isJewelSocket?(v(P,l.skill,!0),D()):l.isMastery||(X.has(l.skill)?X.delete(l.skill):X.add(l.skill))},_e=JSON.parse(C.PossibleStats||"{}");let Ne=re(()=>!e(i)||!_e[e(i).value]?[]:Object.keys(_e[e(i).value])),et=re(()=>e(Ne).map(l=>{const E=parseInt(l);return{label:pr(E),value:E}}).filter(l=>!(l.value in e(j)))),ct=T(void 0);const Pr=l=>{var E;e(j)[l.detail.value]={weight:1,min:0,id:l.detail.value,minStatTotal:0},v(j,e(j),!0),(E=e(ct))==null||E.handleClear(),D()},Ir=l=>{const E=Object.fromEntries(Object.entries(e(j)).filter(([_])=>Number(_)!==l));v(j,E,!0),D()},Er=()=>{v(j,{},!0),D()};let Oe=T(!1),dt=T(0),vt=T(0),Ce=T(!1),Jt=T(0),Me=T(void 0),qt=T(1),Nt=T(null);const o=()=>{var E;if(!e(P)||!e(i)||!((E=e(w))!=null&&E.value))return;v(qt,e(i).value,!0),v(Nt,e(h)?null:e(w).value,!0),v(Ce,!0),v(Me,void 0);const l={jewel:e(i).value,conqueror:e(w).value,nodes:e(L).filter(_=>!X.has(_.skill)).filter(_=>C.TreeToPassive&&_.skill&&C.TreeToPassive[_.skill]).map(_=>C.TreeToPassive&&_.skill?C.TreeToPassive[_.skill]:null).filter(_=>!!_).map(_=>_.Index),stats:Object.keys(e(j)).map(_=>e(j)[parseInt(_)]),minTotalWeight:e(dt),minTotalStats:e(vt)};if(!pa){console.error("syncWrap is not available");return}pa.search(l,Os(_=>(v(Jt,_,!0),Promise.resolve()))).then(_=>{v(Me,_,!0),v(Ce,!1),v(Oe,!0)})};let F=T(be([]));const se=(l,E)=>{v(b,l,!0),v(F,E,!0),D()};let $=T(be(localStorage.getItem("groupResults")===null?!0:localStorage.getItem("groupResults")==="true"));Ke(()=>{localStorage.setItem("groupResults",e($)?"true":"false")});const ie={physical:"#c79d93",cast:"#b3f8fe",fire:"#ff9a77",cold:"#93d8ff",lightning:"#f8cb76",attack:"#da814d",life:"#c96e6e",chaos:"#d8a7d3",unique:"#af6025",critical:"#b2a7d6"},Q=l=>(Object.keys(ie).forEach(E=>{const _=ie[E];l=l.replace(new RegExp(`(${E}(?:$|\\s))|((?:^|\\s)${E})`,"gi"),`<span style='color: ${_}; font-weight: bold'>$1$2</span>`)}),l),le=l=>l.replace(/<(?!\/span|span\s+style='color:\s*#[0-9a-f]{6};\s*font-weight:\s*bold'[^>]*>)[^>]*>/gi,""),ae=(l,E,_)=>{const A={};return l.forEach(R=>{$e.nodes[R.node].isKeystone||_!=="all"&&(_==="notables"&&!$e.nodes[R.node].isNotable||_==="passives"&&$e.nodes[R.node].isNotable)||(R.result.AlternatePassiveSkill&&R.result.AlternatePassiveSkill.StatsKeys&&R.result.AlternatePassiveSkill.StatsKeys.forEach(W=>{A[W]=[...A[W]||[],R.node]}),R.result.AlternatePassiveAdditionInformations&&R.result.AlternatePassiveAdditionInformations.forEach(W=>{var ee;(ee=W.AlternatePassiveAddition)!=null&&ee.StatsKeys&&W.AlternatePassiveAddition.StatsKeys.forEach(te=>{A[te]=[...A[te]||[],R.node]})}))}),Object.keys(A).map(R=>{const W=pr(parseInt(R));return{stat:E?Q(W):W,rawStat:W,id:R,passives:A[parseInt(R)]}})},ze=(l,E)=>{if(!e(i))return l;switch(E){case"alphabet":return l.sort((_,A)=>_.rawStat.replace(/[#+%]/gi,"").trim().toLowerCase().localeCompare(A.rawStat.replace(/[#+%]/gi,"").trim().toLowerCase()));case"count":return l.sort((_,A)=>A.passives.length-_.passives.length);case"rarity":return l.sort((_,A)=>{var R,W,ee,te;return(((W=_e[((R=e(i))==null?void 0:R.value)||0])==null?void 0:W[_.id])||0)-(((te=_e[((ee=e(i))==null?void 0:ee.value)||0])==null?void 0:te[A.id])||0)});case"value":return l.sort((_,A)=>{var ee,te,ve,he;const R=$t[_.id]||0,W=$t[A.id]||0;return R!=W?W-R:(((te=_e[((ee=e(i))==null?void 0:ee.value)||0])==null?void 0:te[_.id])||0)-(((he=_e[((ve=e(i))==null?void 0:ve.value)||0])==null?void 0:he[A.id])||0)})}return l},je=[{label:"Count",value:"count"},{label:"Alphabetical",value:"alphabet"},{label:"Rarity",value:"rarity"},{label:"Value",value:"value"}];let O=T(be(je.find(l=>l.value===(localStorage.getItem("sortOrder")||"count"))));Ke(()=>{var l;(l=e(O))!=null&&l.value&&localStorage.setItem("sortOrder",e(O).value)});let y=T(be(localStorage.getItem("colored")===null?!0:localStorage.getItem("colored")==="true"));Ke(()=>{localStorage.setItem("colored",e(y)?"true":"false")});let H=T(be(localStorage.getItem("split")===null?!0:localStorage.getItem("split")==="true"));Ke(()=>{localStorage.setItem("split",e(H)?"true":"false")});const Y=l=>{var ee,te;if(l.type!=="paste")return;const _=(((ee=l.clipboardData)==null?void 0:ee.getData("text"))||"").split(`
`);if(_.length<14)return;const A=S.find(ve=>ve.label===_[2]);if(!A)return;let R,W;for(let ve=10;ve<_.length;ve++)if((te=C.TimelessJewelConquerors)!=null&&te[A.value]&&(W=Object.keys(C.TimelessJewelConquerors[A.value]||{}).find(he=>_[ve].indexOf(he)>=0),W)){const he=/(\d+)/.exec(_[ve]);if(!he||he.length===0)continue;R=parseInt(he[1]);break}!W||!R||(v(Oe,!1),v(J,"seed"),v(b,R,!0),v(i,A,!0),v(w,{label:W,value:W},!0),D())};let ce=T(!1),Le=T(!1),pe=T(be([]));Ke(()=>{e(Me)&&e(Oe)&&(v(pe,As(e(qt),e(Nt),e(Me).raw),!0),e(pe).length===1&&v(Le,!1))}),rr("paste",tr,Y);const Xe=re(()=>{var l;return((l=e(i))==null?void 0:l.value)??0}),U=re(()=>{var l;return((l=e(w))==null?void 0:l.value)??""}),Be=re(()=>!e(P)),de=re(()=>Array.from(X));cn(a,{clickNode:K,get circledNode(){return e(P)},get selectedJewel(){return e(Xe)},get selectedConqueror(){return e(U)},get highlighted(){return e(F)},get seed(){return e(b)},get highlightJewels(){return e(Be)},get disabled(){return e(de)},children:(l,E)=>{var _=_i(),A=fe(_);{var R=ee=>{var te=gi(),ve=p(te),he=p(ve),Ar=p(he),Qr=p(Ar);Qr.__click=[jn,ce];var Zr=x(Qr,2),Wa=p(Zr);{var Fa=ne=>{var ye=Jn();k(ne,ye)},Ha=ne=>{var ye=qn();k(ne,ye)};G(Wa,ne=>{e(Oe)?ne(Fa):ne(Ha,!1)})}g(Zr),g(Ar);var Ya=x(Ar,2);{var Ka=ne=>{var ye=Dn(),tt=p(ye);{var zt=De=>{var wt=zn(),cr=fe(wt);Tn(cr,{get queries(){return e(pe)},get showTradeLinks(){return e(Le)},set showTradeLinks(Ve){v(Le,Ve,!0)}});var Lt=x(cr,2);let dr;Lt.__click=[Nn,$],V(Ve=>{dr=Je(Lt,1,"p-1 px-3 bg-blue-500/40 rounded disabled:bg-blue-900/40 mr-2",null,dr,Ve),Lt.disabled=!e(Me)},[()=>({grouped:e($)})]),k(De,wt)};G(tt,De=>{e(Oe)&&De(zt)})}var ft=x(tt,2);ft.__click=[Ln,Oe];var Ge=p(ft,!0);g(ft),g(ye),V(()=>Re(Ge,e(Oe)?"Config":"Results")),k(ne,ye)};G(Ya,ne=>{e(Me)&&ne(Ka)})}g(he);var $r=x(he,2);{var Ua=ne=>{var ye=fi(),tt=fe(ye);hr(tt,{get items(){return S},get value(){return e(i)},set value(Ge){v(i,Ge,!0)},$$events:{change:Er}});var zt=x(tt,2);{var ft=Ge=>{var De=vi(),wt=fe(De),cr=x(p(wt),2);hr(cr,{get items(){return e(d)},get value(){return e(f)},set value(Ve){v(f,Ve,!0)},$$events:{change:D}}),g(wt);var Lt=x(wt,2);{var dr=Ve=>{var Dt=di(),Rr=fe(Dt),Or=p(Rr);let ea;Or.__click=[Wn,z];var ta=x(Or,2);let ra;ta.__click=[Fn,z],g(Rr);var aa=x(Rr,2);{var Ga=Ee=>{var rt=si(),Wt=fe(rt),We=x(p(Wt),2);kt(We);var vr=x(We,2);{var Ft=we=>{var Z=Hn(),at=p(Z);g(Z),V(()=>Re(at,`Seed must be between ${C.TimelessJewelSeedRanges[e(i).value].Min??""}
                      and ${C.TimelessJewelSeedRanges[e(i).value].Max??""}`)),k(we,Z)};G(vr,we=>{var Z;e(i)&&((Z=C.TimelessJewelSeedRanges)!=null&&Z[e(i).value])&&(e(b)<C.TimelessJewelSeedRanges[e(i).value].Min||e(b)>C.TimelessJewelSeedRanges[e(i).value].Max)&&we(Ft)})}g(Wt);var Cr=x(Wt,2);{var Mr=we=>{var Z=ai(),at=fe(Z),ht=p(at),Ht=x(p(ht),2);hr(Ht,{get items(){return je},get value(){return e(O)},set value(Se){v(O,Se,!0)}}),g(ht);var gt=x(ht,2),Yt=p(gt);let Kt;Yt.__click=[Yn,y],g(gt);var Ut=x(gt,2),Xt=p(Ut);let yt;Xt.__click=[Kn,H],g(Ut),g(at);var Bt=x(at,2);{var Gt=Se=>{var xe=Gn();let Ae;Ue(xe,21,()=>{var ke;return ze(ae(e(I).filter(Te=>typeof Te.node=="number"),e(y),"all"),((ke=e(O))==null?void 0:ke.value)||"count")},ke=>ke.id,(ke,Te)=>{var st=Bn(),N=p(st);N.__click=[Un,se,b,Te],N.__keydown=[Xn,se,b,Te];var q=p(N);let oe;var ge=p(q);g(q);var me=x(q,2),Fe=p(me);zr(Fe,()=>le(e(Te).stat)),g(me),g(N),g(st),V(mt=>{oe=Je(q,1,"font-bold",null,oe,mt),Re(ge,`(${e(Te).passives.length??""})`)},[()=>({"text-white":($t[e(Te).id]||0)<3})]),k(ke,st)}),g(xe),V(ke=>Ae=Je(xe,1,"mt-4 overflow-auto",null,Ae,ke),[()=>({rainbow:e(y)})]),k(Se,xe)},Vt=Se=>{var xe=ri(),Ae=x(p(xe),2);let ke;Ue(Ae,21,()=>{var N;return ze(ae(e(I).filter(q=>typeof q.node=="number"),e(y),"notables"),((N=e(O))==null?void 0:N.value)||"count")},N=>N.id,(N,q)=>{var oe=Zn(),ge=p(oe);ge.__click=[Vn,se,b,q],ge.__keydown=[Qn,se,b,q];var me=p(ge);let Fe;var mt=p(me);g(me);var nt=x(me,2),bt=p(nt);zr(bt,()=>le(e(q).stat)),g(nt),g(ge),g(oe),V(St=>{Fe=Je(me,1,"font-bold",null,Fe,St),Re(mt,`(${e(q).passives.length??""})`)},[()=>({"text-white":($t[e(q).id]||0)<3})]),k(N,oe)}),g(Ae);var Te=x(Ae,3);let st;Ue(Te,21,()=>{var N;return ze(ae(e(I).filter(q=>typeof q.node=="number"),e(y),"passives"),((N=e(O))==null?void 0:N.value)||"count")},N=>N.id,(N,q)=>{var oe=ti(),ge=p(oe);ge.__click=[$n,se,b,q],ge.__keydown=[ei,se,b,q];var me=p(ge);let Fe;var mt=p(me);g(me);var nt=x(me,2),bt=p(nt);zr(bt,()=>le(e(q).stat)),g(nt),g(ge),g(oe),V(St=>{Fe=Je(me,1,"font-bold",null,Fe,St),Re(mt,`(${e(q).passives.length??""})`)},[()=>({"text-white":($t[e(q).id]||0)<3})]),k(N,oe)}),g(Te),g(xe),V((N,q)=>{ke=Je(Ae,1,"mt-1",null,ke,N),st=Je(Te,1,"mt-1",null,st,q)},[()=>({rainbow:e(y)}),()=>({rainbow:e(y)})]),k(Se,xe)};G(Bt,Se=>{e(H)?Se(Vt,!1):Se(Gt)})}V((Se,xe)=>{Kt=Je(Yt,1,"bg-neutral-600 bg-opacity-20 p-2 px-4 rounded",null,Kt,Se),yt=Je(Xt,1,"bg-neutral-600 bg-opacity-20 p-2 px-4 rounded",null,yt,xe)},[()=>({selected:e(y)}),()=>({selected:e(H)})]),k(we,Z)};G(Cr,we=>{var Z;e(i)&&((Z=C.TimelessJewelSeedRanges)!=null&&Z[e(i).value])&&e(b)>=C.TimelessJewelSeedRanges[e(i).value].Min&&e(b)<=C.TimelessJewelSeedRanges[e(i).value].Max&&we(Mr)})}V(()=>{var we,Z;Hr(We,"min",e(i)&&((we=C.TimelessJewelSeedRanges)!=null&&we[e(i).value])?C.TimelessJewelSeedRanges[e(i).value].Min:0),Hr(We,"max",e(i)&&((Z=C.TimelessJewelSeedRanges)!=null&&Z[e(i).value])?C.TimelessJewelSeedRanges[e(i).value].Max:0)}),rr("blur",We,D),Tt(We,()=>e(b),we=>v(b,we)),k(Ee,rt)},Va=(Ee,rt)=>{{var Wt=We=>{var vr=ui(),Ft=fe(vr),Cr=x(p(Ft),2);Kr(hr(Cr,{get items(){return e(et)},$$events:{change:Pr}}),Z=>v(ct,Z,!0),()=>e(ct)),g(Ft);var Mr=x(Ft,2);{var we=Z=>{var at=oi(),ht=fe(at);Ue(ht,20,()=>Object.keys(e(j)),N=>N,(N,q)=>{var oe=ii(),ge=p(oe),me=p(ge);me.__click=[ni,Ir,j,q];var Fe=x(me,2),mt=p(Fe,!0);g(Fe),g(ge);var nt=x(ge,2),bt=p(nt),St=x(p(bt),2);kt(St),g(bt);var jr=x(bt,2),sa=x(p(jr),2);kt(sa),g(jr);var na=x(jr,2),ia=x(p(na),2);kt(ia),g(na),g(nt),g(oe),V(_t=>Re(mt,_t),[()=>pr(e(j)[parseInt(q)].id)]),Tt(St,()=>e(j)[parseInt(q)].min,_t=>e(j)[parseInt(q)].min=_t),Tt(sa,()=>e(j)[parseInt(q)].weight,_t=>e(j)[parseInt(q)].weight=_t),Tt(ia,()=>e(j)[Number(q)].minStatTotal,_t=>e(j)[Number(q)].minStatTotal=_t),k(N,oe)}),g(ht);var Ht=x(ht,2),gt=p(Ht),Yt=x(p(gt),2);kt(Yt),g(gt);var Kt=x(gt,2),Ut=x(p(Kt),2);kt(Ut),g(Kt),g(Ht);var Xt=x(Ht,2),yt=p(Xt),Bt=p(yt);Bt.__click=[Rn,X];var Gt=x(Bt,2);Gt.__click=[On,L,X];var Vt=x(Gt,2);Vt.__click=[Cn,L,X];var Se=x(Vt,2);Se.__click=[Mn,L,X],g(yt);var xe=x(yt,2),Ae=p(xe);Ae.__click=[li,o];var ke=p(Ae);{var Te=N=>{var q=er();V(()=>{var oe;return Re(q,`${e(Jt)??""} / ${(e(i)&&((oe=C.TimelessJewelSeedRanges)!=null&&oe[e(i).value])?C.TimelessJewelSeedRanges[e(i).value].Max:0)??""}`)}),k(N,q)},st=N=>{var q=er("Search");k(N,q)};G(ke,N=>{e(Ce)?N(Te):N(st,!1)})}g(Ae),g(xe),g(Xt),V(()=>{Bt.disabled=e(Ce)||X.size==0,Gt.disabled=e(Ce)||X.size==0,Vt.disabled=e(Ce)||X.size==0,Se.disabled=e(Ce)||X.size>=e(L).length,Ae.disabled=e(Ce)}),Tt(Yt,()=>e(dt),N=>v(dt,N)),Tt(Ut,()=>e(vt),N=>v(vt,N)),k(Z,at)};G(Mr,Z=>{Object.keys(e(j)).length>0&&Z(we)})}k(We,vr)};G(Ee,We=>{e(J)==="stats"&&We(Wt)},rt)}};G(aa,Ee=>{e(J)==="seed"?Ee(Ga):Ee(Va,!1)})}var Qa=x(aa,2);{var Za=Ee=>{var rt=ci();k(Ee,rt)};G(Qa,Ee=>{e(P)||Ee(Za)})}V((Ee,rt)=>{ea=Je(Or,1,"selection-button",null,ea,Ee),ra=Je(ta,1,"selection-button",null,ra,rt)},[()=>({selected:e(J)==="seed"}),()=>({selected:e(J)==="stats"})]),k(Ve,Dt)};G(Lt,Ve=>{var Dt;e(w)&&e(i)&&((Dt=C.TimelessJewelConquerors)!=null&&Dt[e(i).value])&&e(w).value&&Object.keys(C.TimelessJewelConquerors[e(i).value]||{}).indexOf(e(w).value)>=0&&Ve(dr)})}k(Ge,De)};G(zt,Ge=>{e(i)&&Ge(ft)})}k(ne,ye)};G($r,ne=>{e(Oe)||ne(Ua)})}var Xa=x($r,2);{var Ba=ne=>{var ye=hi(),tt=fe(ye);{var zt=De=>{An(De,{get queries(){return e(pe)}})};G(tt,De=>{e(Le)&&De(zt)})}var ft=x(tt,2);const Ge=re(()=>e(Nt)||"");Sn(ft,{get searchResults(){return e(Me)},get groupResults(){return e($)},highlight:se,get jewel(){return e(qt)},get conqueror(){return e(Ge)}}),k(ne,ye)};G(Xa,ne=>{e(Me)&&e(Oe)&&ne(Ba)})}g(ve),g(te),k(ee,te)},W=ee=>{var te=bi();te.__click=[mi,ce],k(ee,te)};G(A,ee=>{e(ce)?ee(W,!1):ee(R)})}ps(2),k(l,_)},$$slots:{default:!0}}),ut(),s()}ur(["click","keydown"]);export{Ri as component};
