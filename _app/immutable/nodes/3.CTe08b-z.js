var as=Object.defineProperty;var ss=Object.getPrototypeOf;var ns=Reflect.get;var va=a=>{throw TypeError(a)};var is=(a,t,r)=>t in a?as(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r;var ha=(a,t,r)=>is(a,typeof t!="symbol"?t+"":t,r),Lr=(a,t,r)=>t.has(a)||va("Cannot "+r);var b=(a,t,r)=>(Lr(a,t,"read from private field"),r?r.call(a):t.get(a)),G=(a,t,r)=>t.has(a)?va("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,r),st=(a,t,r,s)=>(Lr(a,t,"write to private field"),s?s.call(a,r):t.set(a,r),r),Ee=(a,t,r)=>(Lr(a,t,"access private method"),r);var ga=(a,t,r,s)=>({set _(n){st(a,t,n,r)},get _(){return b(a,t,s)}}),ma=(a,t,r)=>ns(ss(a),r,t);import{b as pa,d as ls,f as C,a as E,c as $r,t as ir}from"../chunks/7J9utlwG.js";import{t as $,i as Ur,j as _a,aa as os,ar as us,y as Xr,ah as cs,ak as ds,ai as fs,o as vs,a8 as br,h as hs,E as gs,w as ms,M as Ra,as as ps,J as _s,C as Ca,O as bs,c as d,at as Tt,g as e,au as ws,s as N,Y as kr,b as W,av as ys,u as Ne,aw as xs,p as it,f as ge,e as k,d as w,r as m,a as lt,ax as lr,ay as Dr,az as Ss,N as Je,F as gt,n as ks}from"../chunks/BG2JjhJ7.js";import{e as It,d as hr,s as Re}from"../chunks/f0mDi-RU.js";import{i as Z}from"../chunks/Db6z-dJC.js";import{a as Ts,c as Ps,d as Ma,s as Br,e as Ke,i as pt,p as Es,S as wr,f as qe,r as Pt,b as Et}from"../chunks/BRyWNxzR.js";import{p as we,r as ja,b as Gr,s as Is,a as As}from"../chunks/oETMcK8Y.js";import{i as Os}from"../chunks/0PjKMJhI.js";import{c as Ja,d as q,s as Rs}from"../chunks/DzQymabd.js";import{a as ba,o as Cs}from"../chunks/DSZY_jMB.js";import{b as Ms,a as He,d as Wr,t as wa,c as mt,o as ya,e as yr,f as xa,i as Sa,g as Fr,h as js,j as ka,k as ea,m as Tr,n as Js,p as qs,q as Ns,s as zs,r as Ls}from"../chunks/BMhmlB4Q.js";import{g as Ds}from"../chunks/ByLtjQE8.js";function Yr(a,t,r=!1,s=!1,n=!1){var u=a,o="";$(()=>{var g=os;if(o===(o=t()??"")){Ur&&_a();return}if(g.nodes_start!==null&&(us(g.nodes_start,g.nodes_end),g.nodes_start=g.nodes_end=null),o!==""){if(Ur){Xr.data;for(var c=_a(),f=c;c!==null&&(c.nodeType!==8||c.data!=="");)f=c,c=cs(c);if(c===null)throw ds(),fs;pa(Xr,f),u=vs(c);return}var p=o+"";r?p=`<svg>${p}</svg>`:s&&(p=`<math>${p}</math>`);var v=ls(p);if((r||s)&&(v=br(v)),pa(br(v),v.lastChild),r||s)for(;br(v);)u.before(br(v));else u.before(v)}})}function Ws(a,t,...r){var s=a,n=Ra,u;hs(()=>{n!==(n=t())&&(u&&(ps(u),u=null),u=ms(()=>n(s,...r)))},gs),Ur&&(s=Xr)}var nt,Ot,cr,Er,qa;const Ir=class Ir{constructor(t){G(this,Er);G(this,nt,new WeakMap);G(this,Ot);G(this,cr);st(this,cr,t)}observe(t,r){var s=b(this,nt).get(t)||new Set;return s.add(r),b(this,nt).set(t,s),Ee(this,Er,qa).call(this).observe(t,b(this,cr)),()=>{var n=b(this,nt).get(t);n.delete(r),n.size===0&&(b(this,nt).delete(t),b(this,Ot).unobserve(t))}}};nt=new WeakMap,Ot=new WeakMap,cr=new WeakMap,Er=new WeakSet,qa=function(){return b(this,Ot)??st(this,Ot,new ResizeObserver(t=>{for(var r of t){Ir.entries.set(r.target,r);for(var s of b(this,nt).get(r.target)||[])s(r)}}))},ha(Ir,"entries",new WeakMap);let Vr=Ir;var Fs=new Vr({box:"border-box"});function Ta(a,t,r){var s=Fs.observe(a,()=>r(a[t]));_s(()=>(Ca(()=>r(a[t])),s))}function Ys(a,t,r,s,n){var u=()=>{s(r[a])};r.addEventListener(t,u),u(),(r===document.body||r===window||r===document)&&bs(()=>{r.removeEventListener(t,u)})}function ar(a){d(a,a.v+1)}const Hs=a=>{const t=a*2,r=t>>16&255,s=t>>8&255,n=t&255;return[r,s,n]},Ks=([a,t,r])=>{const s=(a<<16|t<<8|r)/2;return s%1?0:s},Us=["filter","shadowBlur","globalCompositeOperation","globalAlpha","fillStyle","strokeStyle"],Xs=(a,t,{rgbToId:r=Ks,idToRgb:s=Hs}={})=>{const n=a.getContext("2d",t),u=new OffscreenCanvas(a.width,a.height),o=u.getContext("2d",{willReadFrequently:!1,alpha:!1});return new Proxy(n,{get(g,c){const{width:f,height:p}=a;if((f!==u.width||p!==u.height)&&(u.width=f,u.height=p),c==="getLayerIdAt")return(S,x)=>{const[A,T,R]=o.getImageData(S,x,1,1).data;return r([A,T,R])};if(c==="setCurrentLayerId")return S=>{const[x,A,T]=s(S),R=`rgb(${x},${A},${T})`;o.fillStyle=R,o.strokeStyle=R};const v=g[c];return typeof v!="function"?v:(...S)=>{let x=c,A=S;return c==="drawImage"&&(x="fillRect",A=S.slice(-4)),o[x](...A),Reflect.apply(v,g,S)}},set(g,c,f){return g[c]=f,Us.includes(c)||(o[c]=f),!0}})};var Fe,Ye,Ve,Rt,Pr;const ta=class ta extends Map{constructor(r){super();G(this,Rt);G(this,Fe,new Map);G(this,Ye,Tt(0));G(this,Ve,Tt(0));if(r){for(var[s,n]of r)super.set(s,n);b(this,Ve).v=super.size}}has(r){var s=b(this,Fe),n=s.get(r);if(n===void 0){var u=super.get(r);if(u!==void 0)n=Tt(0),s.set(r,n);else return e(b(this,Ye)),!1}return e(n),!0}forEach(r,s){Ee(this,Rt,Pr).call(this),super.forEach(r,s)}get(r){var s=b(this,Fe),n=s.get(r);if(n===void 0){var u=super.get(r);if(u!==void 0)n=Tt(0),s.set(r,n);else{e(b(this,Ye));return}}return e(n),super.get(r)}set(r,s){var v;var n=b(this,Fe),u=n.get(r),o=super.get(r),g=super.set(r,s),c=b(this,Ye);if(u===void 0)n.set(r,Tt(0)),d(b(this,Ve),super.size),ar(c);else if(o!==s){ar(u);var f=c.reactions===null?null:new Set(c.reactions),p=f===null||!((v=u.reactions)!=null&&v.every(S=>f.has(S)));p&&ar(c)}return g}delete(r){var s=b(this,Fe),n=s.get(r),u=super.delete(r);return n!==void 0&&(s.delete(r),d(b(this,Ve),super.size),d(n,-1),ar(b(this,Ye))),u}clear(){if(super.size!==0){super.clear();var r=b(this,Fe);d(b(this,Ve),0);for(var s of r.values())d(s,-1);ar(b(this,Ye)),r.clear()}}keys(){return e(b(this,Ye)),super.keys()}values(){return Ee(this,Rt,Pr).call(this),super.values()}entries(){return Ee(this,Rt,Pr).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return e(b(this,Ve)),super.size}};Fe=new WeakMap,Ye=new WeakMap,Ve=new WeakMap,Rt=new WeakSet,Pr=function(){e(b(this,Ye));var r=b(this,Fe);if(b(this,Ve).v!==r.size)for(var s of ma(ta.prototype,this,"keys").call(this))r.has(s)||r.set(s,Tt(0));for(var[,n]of b(this,Fe))e(n)};let or=ta;const Bs=a=>{if(window.TouchEvent&&a instanceof TouchEvent){const{left:s,top:n}=a.target.getBoundingClientRect(),{clientX:u,clientY:o}=a.changedTouches[0];return{x:u-s,y:o-n}}const{offsetX:t,offsetY:r}=a;return{x:t,y:r}},Pa=(a,t)=>{var r,s;a instanceof MouseEvent&&((r=a.target)==null||r.dispatchEvent(new PointerEvent(`layer.pointer${t}`,a)),(s=a.target)==null||s.dispatchEvent(new MouseEvent(`layer.mouse${t}`,a)))},Gs=["onclick","oncontextmenu","ondblclick","onauxclick","onmousedown","onmouseenter","onmouseleave","onmouseup","onmousemove","onwheel","ontouchstart","ontouchcancel","ontouchend","ontouchmove","onpointerenter","onpointerleave","onpointerdown","onpointerup","onpointermove","onpointercancel","onlayer.mouseenter","onlayer.mouseleave","onlayer.pointerenter","onlayer.pointerleave","onfocus","onblur","onfullscreenchange","onfullscreenerror","onscroll","oncut","oncopy","onpaste","onkeydown","onkeypress","onkeyup","onmouseover","onmouseout","onselect","ondrag","ondragend","ondragenter","ondragstart","ondragleave","ondragover","ondrop","onpointerover","onpointerout","ongotpointercapture","onlostpointercapture"],Vs=a=>console.warn("[svelte-canvas] %s",a),Na=Symbol("register"),Qs=a=>ws(Na)(a);var Ct,Mt,jt,Ar,Or,dr,_t,ze,Jt,qt,fr,Nt,vr,ve,za,La,Da,Wa,Qr,Fa,Ya;class Zs{constructor(t){G(this,ve);G(this,Ct,new or);G(this,Mt,new or);G(this,jt,new or);G(this,Ar,1);G(this,Or,Date.now());G(this,dr,N(0));G(this,_t);G(this,ze);G(this,Jt);G(this,qt);G(this,fr,N(kr([])));G(this,Nt,N(0));G(this,vr,W(()=>b(this,jt).get(e(b(this,Nt)))));st(this,ze,t),ys(Na,this.register.bind(this))}init(t,r){st(this,_t,t),Ee(this,ve,Wa).call(this,r),Ne(()=>Ee(this,ve,Qr).call(this)),Ne(()=>Ee(this,ve,Da).call(this)),Ne(()=>(e(b(this,dr)),Ee(this,ve,Fa).call(this))),ba(()=>Ee(this,ve,Ya).call(this))}redraw(){xs(b(this,dr))}register({setup:t,render:r,...s}){const n=Ee(this,ve,za).call(this);return t&&b(this,Ct).set(n,t),b(this,Mt).set(n,r),Object.keys(s).length&&(b(this,ze).layerEvents?b(this,jt).set(n,s):Vs("Canvas must have layerEvents={true} in order to use layer-level event handlers")),ba(()=>Ee(this,ve,La).call(this,n)),n}createEventHandlers(){const t=n=>{const u=`on${n.type}`,o=b(this,ze).handlers[u];o==null||o(n)},r=n=>{const{pixelRatio:u}=b(this,ze),{x:o,y:g}=Bs(n);if(["touchstart","pointermove"].includes(n.type)){const p=b(this,_t).getLayerIdAt(o*u,g*u);e(b(this,Nt))!==p&&(Pa(n,"leave"),d(b(this,Nt),p,!0),Pa(n,"enter"))}if(!e(b(this,vr)))return;const c=`on${n.type.replace("layer.","")}`,f=e(b(this,vr))[c];f==null||f({x:o,y:g,originalEvent:n})},s=n=>{t(n),b(this,ze).layerEvents&&r(n)};return Gs.reduce((n,u)=>({...n,[u]:s}),{})}}Ct=new WeakMap,Mt=new WeakMap,jt=new WeakMap,Ar=new WeakMap,Or=new WeakMap,dr=new WeakMap,_t=new WeakMap,ze=new WeakMap,Jt=new WeakMap,qt=new WeakMap,fr=new WeakMap,Nt=new WeakMap,vr=new WeakMap,ve=new WeakSet,za=function(){return ga(this,Ar)._++},La=function(t){b(this,Mt).delete(t),b(this,jt).delete(t)},Da=function(){const{onresize:t,width:r,height:s,pixelRatio:n}=b(this,ze);t==null||t({width:r,height:s,pixelRatio:n})},Wa=function(t){const r=()=>{const s=[...t.children];d(b(this,fr),s.map(n=>+n.dataset.layerId),!0)};st(this,qt,new MutationObserver(()=>r())),b(this,qt).observe(t,{childList:!0}),r()},Qr=function(){b(this,ze).autoplay?(Ca(()=>this.redraw()),st(this,Jt,requestAnimationFrame(()=>Ee(this,ve,Qr).call(this)))):cancelAnimationFrame(b(this,Jt))},Fa=function(){var c,f,p;const t=b(this,_t),{width:r,height:s,pixelRatio:n,autoclear:u}=b(this,ze),o=Date.now()-b(this,Or),g={context:t,width:r,height:s,time:o};t.setTransform(n,0,0,n,0,0),u&&t.clearRect(0,0,r,s);for(const[v,S]of b(this,Ct))S(g),b(this,Ct).delete(v);for(const v of e(b(this,fr)))(f=(c=b(this,_t)).setCurrentLayerId)==null||f.call(c,v),(p=b(this,Mt).get(v))==null||p(g)},Ya=function(){var t;typeof window>"u"||((t=b(this,qt))==null||t.disconnect(),cancelAnimationFrame(b(this,Jt)))};/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function $s(a,t){var r=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(r!=null){var s,n,u,o,g=[],c=!0,f=!1;try{if(u=(r=r.call(a)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(s=u.call(r)).done)&&(g.push(s.value),g.length!==t);c=!0);}catch(p){f=!0,n=p}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw n}}return g}}function Ea(a,t){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),r.push.apply(r,s)}return r}function Ie(a){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ea(Object(r),!0).forEach(function(s){en(a,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Ea(Object(r)).forEach(function(s){Object.defineProperty(a,s,Object.getOwnPropertyDescriptor(r,s))})}return a}function en(a,t,r){return t=cn(t),t in a?Object.defineProperty(a,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[t]=r,a}function tn(a,t){if(a==null)return{};var r={},s=Object.keys(a),n,u;for(u=0;u<s.length;u++)n=s[u],!(t.indexOf(n)>=0)&&(r[n]=a[n]);return r}function rn(a,t){if(a==null)return{};var r=tn(a,t),s,n;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(a);for(n=0;n<u.length;n++)s=u[n],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(a,s)&&(r[s]=a[s])}return r}function Ia(a,t){return sn(a)||$s(a,t)||Ha(a,t)||on()}function xr(a){return an(a)||nn(a)||Ha(a)||ln()}function an(a){if(Array.isArray(a))return Zr(a)}function sn(a){if(Array.isArray(a))return a}function nn(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function Ha(a,t){if(a){if(typeof a=="string")return Zr(a,t);var r=Object.prototype.toString.call(a).slice(8,-1);if(r==="Object"&&a.constructor&&(r=a.constructor.name),r==="Map"||r==="Set")return Array.from(a);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zr(a,t)}}function Zr(a,t){(t==null||t>a.length)&&(t=a.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=a[r];return s}function ln(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function on(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function un(a,t){if(typeof a!="object"||a===null)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var s=r.call(a,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(a)}function cn(a){var t=un(a,"string");return typeof t=="symbol"?t:String(t)}function ur(a){var t=a.sizes.shift(),r=Math.max(Math.ceil(t[0]),1),s=Math.max(Math.ceil(t[1]),1),n=[r-1,s-1,1,1],u=Date.now(),o=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,g,c;o?(g=new OffscreenCanvas(1,1),c=new OffscreenCanvas(r,s)):(g=document.createElement("canvas"),g.width=1,g.height=1,c=document.createElement("canvas"),c.width=r,c.height=s);var f=g.getContext("2d"),p=c.getContext("2d");p&&(p.fillRect.apply(p,n),f.drawImage(c,r-1,s-1,1,1,0,0,1,1));var v=f&&f.getImageData(0,0,1,1).data[3]!==0,S=Date.now()-u;return[g,c].forEach(function(x){x.height=0,x.width=0}),o?(postMessage({width:r,height:s,benchmark:S,isTestPass:v}),!v&&a.sizes.length&&ur(a)):v?a.onSuccess(r,s,S):(a.onError(r,s,S),a.sizes.length&&ur(a)),v}var Hr={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},dn=["onError","onSuccess"],At={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},sr={};function Kr(a){var t=a.width===a.height,r=a.height===1,s=a.width===1,n=[];if(!a.width||!a.height)a.sizes.forEach(function(p){var v=t||r?p:1,S=t||s?p:1;n.push([v,S])});else for(var u=a.min||At.min,o=a.step||At.step,g=Math.max(a.width,a.height);g>=u;){var c=t||r?g:1,f=t||s?g:1;n.push([c,f]),g-=o}return n}function Sr(a){var t=window&&"HTMLCanvasElement"in window,r=window&&"OffscreenCanvas"in window,s=Date.now(),n=a.onError,u=a.onSuccess,o=rn(a,dn),g=null;if(!t)return!1;if(a.useWorker&&r){var c=`
            var canvasTest = `.concat(ur.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),f=new Blob([c],{type:"application/javascript"}),p=URL.createObjectURL(f);g=new Worker(p),URL.revokeObjectURL(p),g.onmessage=function(v){var S=v.data,x=S.width,A=S.height,T=S.benchmark,R=S.isTestPass;R?(sr[s].onSuccess(x,A,T),delete sr[s]):sr[s].onError(x,A,T)}}if(a.usePromise)return new Promise(function(v,S){var x=Ie(Ie({},a),{},{onError:function(M,ae,L){var D;if(a.sizes.length===0)D=!0;else{var z=a.sizes.slice(-1),F=Ia(z,1),Y=Ia(F[0],2),ye=Y[0],V=Y[1];D=M===ye&&ae===V}n(M,ae,L),D&&S({width:M,height:ae,benchmark:L})},onSuccess:function(M,ae,L){u(M,ae,L),v({width:M,height:ae,benchmark:L})}});if(g){var A=x.onError,T=x.onSuccess;sr[s]={onError:A,onSuccess:T},g.postMessage(o)}else ur(x)});if(g)sr[s]={onError:n,onSuccess:u},g.postMessage(o);else return ur(a)}var fn={maxArea:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Kr({width:t.max,height:t.max,min:t.min,step:t.step,sizes:xr(Hr.area)}),s=Ie(Ie(Ie({},At),t),{},{sizes:r});return Sr(s)},maxHeight:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Kr({width:1,height:t.max,min:t.min,step:t.step,sizes:xr(Hr.height)}),s=Ie(Ie(Ie({},At),t),{},{sizes:r});return Sr(s)},maxWidth:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Kr({width:t.max,height:1,min:t.min,step:t.step,sizes:xr(Hr.width)}),s=Ie(Ie(Ie({},At),t),{},{sizes:r});return Sr(s)},test:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=Ie(Ie({},At),t);return r.sizes=xr(r.sizes),r.width&&r.height&&(r.sizes=[[r.width,r.height]]),Sr(r)}};const vn=(a,t,r,s=.1)=>{if(typeof window>"u")return r;for(;!fn.test({sizes:[[a*r,t*r]]});)r-=s;return r};var hn=C("<canvas></canvas> <div><!></div>",1);function gn(a,t){it(t,!0);let r=we(t,"style",3,""),s=we(t,"autoplay",3,!1),n=we(t,"autoclear",3,!0),u=we(t,"layerEvents",3,!1),o=ja(t,["$$slots","$$events","$$legacy","width","height","pixelRatio","class","style","autoplay","autoclear","layerEvents","onresize","contextSettings","children"]),g,c,f,p=N(2),v=N(0),S=N(0);const x=W(()=>t.width??e(v)),A=W(()=>t.height??e(S)),T=W(()=>e(p)&&t.pixelRatio==="auto"?vn(e(x),e(A),e(p)):t.pixelRatio&&t.pixelRatio!=="auto"?t.pixelRatio:e(p)),R=new Zs({get width(){return e(x)},get height(){return e(A)},get pixelRatio(){return e(T)},get autoplay(){return s()},get autoclear(){return n()},get layerEvents(){return u()},get onresize(){return t.onresize},handlers:o});Cs(()=>{u()?c=Xs(g,t.contextSettings):c=g.getContext("2d",t.contextSettings),R.init(c,f)});const M=()=>R.redraw();var ae=hn(),L=ge(ae);Ts(L,F=>({class:t.class,width:e(x)*e(T),height:e(A)*e(T),style:r(),...F,[Ps]:{width:t.width?`${t.width}px`:"100%",height:t.height?`${t.height}px`:"100%"}}),[()=>R.createEventHandlers()]),Gr(L,F=>g=F,()=>g);var D=k(L,2);Ma(D,"",{},{display:"none"});var z=w(D);return Ws(z,()=>t.children??Ra),m(D),Gr(D,F=>f=F,()=>f),Ys("devicePixelRatio","resize",lr,F=>d(p,F,!0)),Ta(L,"clientWidth",F=>d(v,F)),Ta(L,"clientHeight",F=>d(S,F)),E(a,ae),lt({redraw:M,get canvas(){return g},set canvas(F){g=F},get context(){return c},set context(F){c=F}})}var mn=C("<div></div>");function pn(a,t){it(t,!0);const r=ja(t,["$$slots","$$events","$$legacy"]),s=Qs(r);var n=mn();$(()=>Br(n,"data-layer-id",s)),E(a,n),lt()}var _n=C("<div><!> <!></div>");function bn(a,t){it(t,!1);const r=Je(),s=Je();let n=we(t,"clickNode",8),u=we(t,"circledNode",8),o=we(t,"selectedJewel",8),g=we(t,"selectedConqueror",8),c=we(t,"seed",8),f=we(t,"highlighted",24,()=>[]),p=we(t,"disabled",24,()=>[]),v=we(t,"highlightJewels",8,!1);const S=[427,320,226,227,323,422,329],x="25px Roboto Mono",A="17px Roboto Mono";let T=Je(10),R=Je(0),M=Je(0);const ae=2.6,L={},D={},z=(i,le,me,se=!1,de=!1)=>{let U=se?js[le]:ka[le];!U&&se&&(U=ka[le]);const ee=U.filename;ee in(se?D:L)||((se?D:L)[ee]=new Image,(se?D:L)[ee].src=ee);const ne=U.coords[le],Ze=ne.w/e(T)*ae,Q=ne.h/e(T)*ae,I=me.x-Ze/2,j=me.y-Q/2;let X=j;de&&(X=j-Q/2),i.drawImage((se?D:L)[ee],ne.x,ne.y,ne.w,ne.h,I,X,Ze,Q),de&&(i.save(),i.translate(I,j),i.rotate(Math.PI),i.drawImage((se?D:L)[ee],ne.x,ne.y,ne.w,ne.h,-Ze,-(Q/2),Ze,-Q),i.restore())},F=(i,le,me)=>{const se=[];let de="";return i.split(" ").forEach(U=>{le.measureText(de+U).width<me?de+=" "+U:(se.push(de.trim()),de=U)}),de.length>0&&se.push(de.trim()),se};let Y=Je({x:Number.MIN_VALUE,y:Number.MIN_VALUE}),ye=Je("unset"),V=Je(),bt=0,gr=0,zt=0,Ue=0,ot=!1;const Qe=i=>{ot=!0,bt=i.offsetX,gr=i.offsetY,zt=e(R),Ue=e(M),d(Y,{x:i.offsetX,y:i.offsetY}),e(V)&&n()(e(V))},Rr=i=>{i.type==="pointerup"&&(ot=!1),d(Y,{x:i.offsetX,y:i.offsetY})},Cr=i=>{ot&&(d(R,zt-(bt-i.offsetX)*e(T)),d(M,Ue-(gr-i.offsetY)*e(T))),d(Y,{x:i.offsetX,y:i.offsetY})},Ce=i=>{i.deltaY>0?e(T)<30&&(d(R,e(R)+i.offsetX),d(M,e(M)+i.offsetY)):e(T)>3&&(d(R,e(R)-i.offsetX),d(M,e(M)-i.offsetY)),d(T,Math.min(30,Math.max(3,e(T)+i.deltaY/100))),i.preventDefault(),i.stopPropagation(),i.stopImmediatePropagation()};let wt=Je(0),Lt=Je(0);const Dt=()=>{d(wt,window.innerWidth),d(Lt,window.innerHeight)};let Wt=Je(!1);Dr(()=>e(T),()=>{d(r,Ms/e(T))}),Dr(()=>(e(Wt),e(T)),()=>{!e(Wt)&&He&&(d(Wt,!0),d(R,He.min_x+window.innerWidth/2*e(T)),d(M,He.min_y+window.innerHeight/2*e(T))),Dt()}),Dr(()=>(e(R),e(M),e(T),gt(u()),e(r),gt(p()),gt(f()),gt(v()),e(Y),e(V),gt(c()),gt(o()),gt(g()),Fr),()=>{d(s,({context:i,width:le,height:me})=>{const se=window.performance.now();i.clearRect(0,0,le,me),i.fillStyle="#080c11",i.fillRect(0,0,le,me);const de={};Object.keys(Wr).forEach(Q=>{const I=Wr[Q],j=wa(I.x,I.y,e(R),e(M),e(T)),X=Math.max(...I.orbits);S.indexOf(parseInt(Q))>=0||(X==1?z(i,"PSGroupBackground1",j,!1):X==2?z(i,"PSGroupBackground2",j,!1):(X==3||I.orbits.length>1)&&z(i,"PSGroupBackground3",j,!1,!0))}),Object.keys(mt).forEach(Q=>{var B;const I=mt[Q],j=ya(I.orbit,I.orbitIndex),X=yr(I,e(R),e(M),e(T));(B=I.out)==null||B.forEach(Be=>{if(!mt[parseInt(Be)])return;const Me=Math.min(parseInt(Be),parseInt(Q)),ut=Math.max(parseInt(Be),parseInt(Q)),l=Me+":"+ut;if(l in de)return;de[l]=!0;const _=mt[parseInt(Be)];if(!_||_.isMastery)return;const h=ya(_.orbit,_.orbitIndex),P=yr(_,e(R),e(M),e(T));if(i.beginPath(),I.group!=_.group||I.orbit!=_.orbit)i.moveTo(X.x,X.y),i.lineTo(P.x,P.y);else{let y=Math.PI/180-Math.PI/180*j,O=Math.PI/180-Math.PI/180*h;y-=Math.PI/2,O-=Math.PI/2;const H=Math.abs(Math.max(y,O)-Math.min(y,O)),te=H>Math.PI?Math.max(y,O):Math.min(y,O),xe=H>Math.PI?Math.min(y,O):Math.max(y,O),he=Wr[I.group],Ae=wa(he.x,he.y,e(R),e(M),e(T));i.arc(Ae.x,Ae.y,He.constants.orbitRadii[I.orbit]/e(T)+1,te,xe)}i.lineWidth=6/e(T),i.strokeStyle="#524518",i.stroke()})});let U;u()&&(U=yr(mt[u()],e(R),e(M),e(T)),i.strokeStyle="#ad2b2b");let ee=!1,ne;if(Object.keys(mt).forEach(Q=>{const I=mt[Q],j=yr(I,e(R),e(M),e(T));let X=0,B=!1;u()&&xa(j,U)<e(r)&&(B=!0),p().indexOf(I.skill)>=0&&(B=!1),I.isKeystone?(X=110,z(i,I.icon,j,B),B?z(i,"KeystoneFrameAllocated",j,!1):z(i,"KeystoneFrameUnallocated",j,!1)):I.isNotable?(X=70,z(i,I.icon,j,B),B?z(i,"NotableFrameAllocated",j,!1):z(i,"NotableFrameUnallocated",j,!1)):I.isJewelSocket?(X=70,I.expansionJewel?z(i,"JewelSocketAltNormal",j,!1):B?z(i,"JewelFrameAllocated",j,!1):z(i,"JewelFrameUnallocated",j,!1)):I.isMastery?z(i,I.inactiveIcon,j,B):(X=50,z(i,I.icon,j,B),B?z(i,"PSSkillFrameActive",j,!1):z(i,"PSSkillFrame",j,!1)),(f().indexOf(I.skill)>=0||v()&&I.isJewelSocket)&&((!f()||!f().length)&&!v()?i.strokeStyle="#ffffff":i.strokeStyle="#00ff00",i.lineWidth=3,i.beginPath(),i.arc(j.x,j.y,(X+30)/e(T),0,Math.PI*2),i.stroke()),xa(j,e(Y))<X/e(T)&&(ne=I,ee=B)}),d(V,ne),u()&&(i.strokeStyle="#ad2b2b",i.lineWidth=1,i.beginPath(),i.arc(U.x,U.y,e(r),0,Math.PI*2),i.stroke()),e(V)){let Q=e(V).name,I=(e(V).stats||[]).map(l=>({text:l,special:!1}));if(!e(V).isJewelSocket&&ee&&e(V).skill&&c()&&o()&&g()){const l=Ja.Calculate(q.TreeToPassive[e(V).skill].Index,c(),o(),g());l&&("AlternatePassiveSkill"in l&&l.AlternatePassiveSkill&&(I=[],Q=l.AlternatePassiveSkill.Name,"StatsKeys"in l.AlternatePassiveSkill&&l.AlternatePassiveSkill.StatsKeys.forEach((_,h)=>{const P=q.GetStatByIndex(_),y=Sa[P.ID]||"";y&&I.push({text:Fr(y,l.StatRolls[h])||P.ID,special:!0})})),l.AlternatePassiveAdditionInformations&&l.AlternatePassiveAdditionInformations.forEach(_=>{"StatsKeys"in _.AlternatePassiveAddition&&_.AlternatePassiveAddition.StatsKeys.forEach((h,P)=>{const y=q.GetStatByIndex(h),O=Sa[y.ID]||"";O&&I.push({text:Fr(O,_.StatRolls[P])||y.ID,special:!0})})}))}i.font=x;const j=i.measureText(Q),X=Math.max(j.width+50,600);i.font=A;const B=[],Be=30;let Me=85;I&&I.length>0?I.forEach(l=>{B.length>0&&(Me+=5),l.text.split(`
`).forEach(_=>{B.length>0&&(Me+=10),F(_,i,X-Be).forEach(P=>{B.push({text:P,offset:Me,special:l.special}),Me+=20})})}):e(V).isJewelSocket&&(B.push({text:"Click to select this socket",offset:Me,special:!0}),Me+=20);const ut=55;i.fillStyle="rgba(75,63,24,0.9)",i.fillRect(e(Y).x,e(Y).y,X,ut),i.fillStyle="#ffffff",i.font=x,i.textAlign="center",i.fillText(Q,e(Y).x+X/2,e(Y).y+35),i.fillStyle="rgba(0,0,0,0.8)",i.fillRect(e(Y).x,e(Y).y+ut,X,Me-ut),i.font=A,i.textAlign="left",B.forEach(l=>{l.special?i.fillStyle="#8cf34c":i.fillStyle="#ffffff",i.fillText(l.text,e(Y).x+Be/2,e(Y).y+l.offset)})}e(V)&&e(V).isJewelSocket?d(ye,"pointer"):d(ye,"unset"),i.fillStyle="#ffffff",i.textAlign="right",i.font="12px Roboto Mono";const Ze=window.performance.now();i.fillText(`${(Ze-se).toFixed(1)}ms`,le-5,17)})}),Ss(),Os();var mr=$r();It("pointerup",lr,Rr),It("pointermove",lr,Cr),It("resize",lr,Dt);var Mr=ge(mr);{var Xe=i=>{var le=_n(),me=w(le);gn(me,{get width(){return e(wt)},get height(){return e(Lt)},$$events:{pointerdown:Qe,wheel:Ce},children:(de,U)=>{pn(de,{get render(){return e(s)}})},$$slots:{default:!0}});var se=k(me,2);Rs(se,t,"default",{},null),m(le),$(()=>Ma(le,`touch-action: none; cursor: ${e(ye)??""}`)),It("resize",le,Dt),E(i,le)};Z(Mr,i=>{e(wt)&&e(Lt)&&i(Xe)})}E(a,mr),lt()}const Aa=(a,t)=>t.highlight(t.set.seed,t.set.skills.map(r=>r.passive));var wn=(a,t)=>ea(Js(t.jewel,t.conqueror,t.set)),yn=C("<li> </li>"),xn=C('<div class="mt-2"><span> </span> <ul class="list-disc pl-6 font-bold"></ul></div>'),Sn=C('<div class="my-2 border-white/50 border p-2 flex flex-col cursor-pointer" role="button" tabindex="0"><div class="flex flex-row justify-between"><button class="px-3 invisible">Trade</button> <div class="font-bold text-orange-500 text-center"> </div> <button class="px-3 bg-blue-500/40 rounded">Trade</button></div> <!></div>');function Oa(a,t){it(t,!0);var r=Sn();r.__click=[Aa,t],r.__keydown=[Aa,t];var s=w(r),n=k(w(s),2),u=w(n);m(n);var o=k(n,2);o.__click=[wn,t],m(s);var g=k(s,2);Ke(g,17,()=>t.set.skills,c=>c.passive,(c,f)=>{var p=xn(),v=w(p),S=w(v);m(v);var x=k(v,2);Ke(x,20,()=>Object.keys(e(f).stats),A=>A,(A,T)=>{var R=yn(),M=w(R,!0);m(R),$(ae=>Re(M,ae),[()=>Tr(parseInt(T),e(f).stats[T])]),E(A,R)}),m(x),m(p),$(()=>Re(S,`${He.nodes[e(f).passive].name??""} (${e(f).passive??""})`)),E(c,p)}),m(r),$(()=>Re(u,`Seed ${t.set.seed??""} (weight ${t.set.weight??""}) Stat Total: ${t.set.statTotal??""}`)),E(a,r),lt()}hr(["click","keydown"]);var kn=(a,t,r)=>e(t)===String(r)?d(t,""):d(t,String(r),!0),Tn=C("<div><!></div>"),Pn=C('<div class="flex flex-col overflow-auto min-h-[200px] mb-2"></div>'),En=C('<button class="text-lg w-full p-2 px-4 rounded flex flex-row justify-between mb-2" style="background-color: rgba(107, 114, 128, 0.3);"><span> </span> <span> </span></button> <!>',1),In=C('<div class="flex flex-col overflow-auto"></div>'),An=C("<div><!></div>"),On=C('<div class="mt-4 flex flex-col overflow-auto"></div>');function Rn(a,t){it(t,!0);let r=we(t,"groupResults",3,!0),s=N("");var n=$r(),u=ge(n);{var o=c=>{var f=In();Ke(f,20,()=>Object.keys(t.searchResults.grouped).map(p=>parseInt(p,10)).sort((p,v)=>p-v).reverse(),p=>p,(p,v)=>{var S=En(),x=ge(S);x.__click=[kn,s,v];var A=w(x),T=w(A);m(A);var R=k(A,2),M=w(R,!0);m(R),m(x);var ae=k(x,2);{var L=D=>{var z=Pn();Ke(z,21,()=>t.searchResults.grouped[v],pt,(F,Y)=>{var ye=Tn(),V=w(ye);Oa(V,{get set(){return e(Y)},get highlight(){return t.highlight},get jewel(){return t.jewel},get conqueror(){return t.conqueror}}),m(ye),E(F,ye)}),m(z),E(D,z)};Z(ae,D=>{e(s)===String(v)&&D(L)})}$(D=>{Re(T,`${v??""} Match${v>1?"es":""} [${t.searchResults.grouped[v].length??""}]`),Re(M,D)},[()=>e(s)===String(v)?"^":"V"]),E(p,S)}),m(f),E(c,f)},g=c=>{var f=On();Ke(f,21,()=>t.searchResults.raw,pt,(p,v)=>{var S=An(),x=w(S);Oa(x,{get set(){return e(v)},get highlight(){return t.highlight},get jewel(){return t.jewel},get conqueror(){return t.conqueror}}),m(S),E(p,S)}),m(f),E(c,f)};Z(u,c=>{r()?c(o):c(g,!1)})}E(a,n),lt()}hr(["click"]);const nr={25:1,26:1,42:1,49:1,56:1,63:1,70:2,95:4,117:1,124:4,134:1,150:2,216:1,434:1,482:1,483:1,484:1,488:1,554:1,556:1,593:3,594:3,595:3,619:1,943:1,944:1,945:1,946:1,2133:4,3108:3,3109:4,3110:4,3111:4,5815:4,8835:1,9091:1,9772:1,14775:2,209:1,447:1,573:2,1294:1,1361:1,2031:5,8177:2,448:2,486:1,579:2,1404:1,2030:5,9090:1,9711:2,9712:2,9713:2,9714:2,9716:1,9717:1,9718:1,9721:1,9722:1,9723:1,9724:1,186:2,490:1,1251:3,1654:1,3392:1,6042:1,6048:1,6049:1,6050:1,6136:1,7499:2},Cn=(a,t,r,s)=>{t.queries.length===1?ea(t.queries[0]):e(r)&&s(!s())};var Mn=C('<button class="p-1 px-3 bg-blue-500/40 rounded disabled:bg-blue-900/40 mr-2"><!></button>');function jn(a,t){it(t,!0);let r=we(t,"showTradeLinks",15,!1),s=W(()=>t.queries.length>1);var n=Mn();n.__click=[Cn,t,s,r];var u=w(n);{var o=c=>{var f=$r(),p=ge(f);{var v=x=>{var A=ir("Hide Trade Links");E(x,A)},S=x=>{var A=ir("Show Trade Links");E(x,A)};Z(p,x=>{r()?x(v):x(S,!1)})}E(c,f)},g=c=>{var f=ir("Trade");E(c,f)};Z(u,c=>{e(s)?c(o):c(g,!1)})}m(n),$(()=>n.disabled=!t.queries),E(a,n),lt()}hr(["click"]);var Jn=(a,t)=>ea(e(t)),qn=C('<button class="p-1 px-3 bg-blue-500/40 rounded"></button>'),Nn=C('<div class="flex flex-wrap gap-2.5 my-2"></div>');function zn(a,t){it(t,!0);var r=Nn();Ke(r,21,()=>t.queries,pt,(s,n,u)=>{var o=qn();o.__click=[Jn,n],o.textContent=`Trade Batch ${u+1}`,E(s,o)}),m(r),E(a,r),lt()}hr(["click"]);const Ln=(a,t)=>{d(t,new Set,!0)},Dn=(a,t,r)=>{const s=new Set(e(t));e(r)().forEach(n=>{n.isNotable&&n.skill!==void 0&&s.delete(n.skill)}),d(t,s,!0)},Wn=(a,t,r)=>{const s=new Set(e(t));e(r)().forEach(n=>{!n.isNotable&&n.skill!==void 0&&s.delete(n.skill)}),d(t,s,!0)},Fn=(a,t,r)=>{const s=new Set;e(t)().filter(n=>!n.isJewelSocket&&!n.isMastery&&n.skill!==void 0).forEach(n=>s.add(n.skill)),d(r,s,!0)};var Yn=(a,t)=>d(t,!0),Hn=C("<span>Results</span>"),Kn=C("<span>Timeless Jewel</span>"),Un=(a,t)=>d(t,!e(t)),Xn=C("<!> <button>Grouped</button>",1),Bn=(a,t)=>d(t,!e(t)),Gn=C('<div class="flex flex-row"><!> <button class="bg-neutral-100 opacity-20 px-4 p-1 rounded"> </button></div>'),Vn=(a,t)=>t("seed"),Qn=(a,t)=>t("stats"),Zn=C('<div class="mt-2"> </div>'),$n=(a,t)=>d(t,!e(t)),ei=(a,t)=>d(t,!e(t)),ti=(a,t,r,s)=>t(e(r),e(s).passives),ri=(a,t,r,s)=>a.key==="Enter"&&t(e(r),e(s).passives),ai=C('<li><button class="cursor-pointer w-full text-left"><span> </span> <span class="text-white"><!></span></button></li>'),si=C("<ul></ul>"),ni=(a,t,r,s)=>t(e(r),e(s).passives),ii=(a,t,r,s)=>a.key==="Enter"&&t(e(r),e(s).passives),li=C('<li><button class="cursor-pointer w-full text-left"><span> </span> <span class="text-white"><!></span></button></li>'),oi=(a,t,r,s)=>t(e(r),e(s).passives),ui=(a,t,r,s)=>a.key==="Enter"&&t(e(r),e(s).passives),ci=C('<li><button class="cursor-pointer w-full text-left"><span> </span> <span class="text-white"><!></span></button></li>'),di=C('<div class="overflow-auto mt-4"><h3>Notables</h3> <ul></ul> <h3 class="mt-2">Smalls</h3> <ul></ul></div>'),fi=C('<div class="flex flex-row mt-4 items-end"><div class="flex-grow"><h3 class="mb-2">Sort Order</h3> <!></div> <div class="ml-2"><button>Colors</button></div> <div class="ml-2"><button>Split</button></div></div> <!>',1),vi=C('<div class="mt-4"><h3 class="mb-2">Seed</h3> <input type="number"/> <!></div> <!>',1),hi=(a,t,r,s)=>t(e(r)[parseInt(e(s))].id),gi=C('<div class="mb-4 flex flex-row items-start flex-col border-neutral-100 border-opacity-40 border-b pb-4"><div><button class="p-2 px-4 bg-red-500/40 rounded mr-2">-</button> <span> </span></div> <div class="mt-2 flex flex-row"><div class="mr-4 flex flex-row items-center"><div class="mr-2">Min:</div> <input type="number" min="0"/></div> <div class="flex flex-row items-center"><div class="mr-2">Weight:</div> <input type="number" min="0"/></div> <div class="flex flex-row items-center"><div class="mr-2">Minimum Stat Total:</div> <input type="number" min="0"/></div></div></div>'),mi=(a,t)=>t(),pi=C('<div class="mt-4 flex flex-col overflow-auto min-h-[100px]"></div> <div class="flex flex-col mt-2"><div class="flex flex-row items-center"><div class="mr-2 min-w-fit">Min Total Weight:</div> <input type="number" min="0"/></div> <div class="flex flex-row items-center"><div class="mr-2 min-w-fit">Minimum Stat Total:</div> <input type="number" min="0"/></div></div> <div class="flex flex-col mt-4"><div class="flex flex-row"><button class="p-2 px-2 bg-yellow-500/40 rounded disabled:bg-yellow-900/40 mr-2">Select All</button> <button class="p-2 px-2 bg-yellow-500/40 rounded disabled:bg-yellow-900/40 mr-2">Notables</button> <button class="p-2 px-2 bg-yellow-500/40 rounded disabled:bg-yellow-900/40 mr-2">Passives</button> <button class="p-2 px-2 bg-yellow-500/40 rounded disabled:bg-yellow-900/40 flex-grow">Deselect</button></div> <div class="flex flex-row mt-2"><button class="p-2 px-3 bg-green-500/40 rounded disabled:bg-green-900/40 flex-grow"><!></button></div></div>',1),_i=C('<div class="mt-4"><h3 class="mb-2">Add Stat</h3> <!></div> <!>',1),bi=C('<h2 class="mt-4">Click on a jewel socket</h2>'),wi=C('<div class="mt-4 w-full flex flex-row"><button>Enter Seed</button> <button>Select Stats</button></div> <!> <!>',1),yi=C('<div class="mt-4"><h3 class="mb-2">Conqueror</h3> <!></div> <!>',1),xi=C("<!> <!>",1),Si=C("<!> <!>",1),ki=C('<div class="w-screen md:w-10/12 lg:w-2/3 xl:w-1/2 2xl:w-5/12 3xl:w-1/3 4xl:w-1/4 absolute top-0 left-0 bg-black/80 backdrop-blur-sm themed rounded-br-lg max-h-screen"><div class="p-4 max-h-screen flex flex-col"><div class="flex flex-row justify-between mb-2"><div class="flex flex-row items-center"><button class="burger-menu mr-3" aria-label="Open menu"><div></div> <div></div> <div></div></button> <h3 class="flex-grow"><!></h3></div> <!></div> <!> <!></div></div>'),Ti=(a,t)=>d(t,!1),Pi=C('<button class="burger-menu absolute top-0 left-0 bg-black/80 backdrop-blur-sm rounded-br-lg p-4 pt-5" aria-label="Close menu"><div></div> <div></div> <div></div></button>'),Ei=C('<!> <div class="text-orange-500 absolute bottom-0 right-0 m-2"><a href="https://github.com/Vilsol/timeless-jewels" target="_blank" rel="noopener noreferrer">Official Branch Source (Github)</a> <a href="https://github.com/BlazesRus/timeless-jewels" target="_blank" rel="noopener noreferrer">Source (Github)</a></div>',1);function Di(a,t){it(t,!0);const[r,s]=As(),u=Is(Es,"$page",r).url.searchParams;let o=N(void 0),g=N(void 0),c=N(void 0),f=N(0),p=N(void 0),v=N(kr({})),S=N(""),x=N(kr(new Set)),A=N(!1),T=N(0),R=N(0),M=N(!1),ae=N(0),L=N(void 0),D=N(1),z=N(null),F=N(kr([])),Y=N(!0),ye=N(void 0),V=W(()=>()=>{var l;return(l=q)!=null&&l.TimelessJewels?Object.keys(q.TimelessJewels).map(_=>({value:parseInt(_),label:q.TimelessJewels[parseInt(_)]})):[]}),bt=W(()=>()=>{var _,h;if(!e(o)||!((h=(_=q)==null?void 0:_.TimelessJewelConquerors)!=null&&h[e(o).value]))return[];const l=q.TimelessJewelConquerors[e(o).value];return l?Object.keys(l).map(P=>({value:P,label:P})):[]}),gr=W(()=>()=>e(bt)().concat([{value:"Any",label:"Any"}])),zt=W(()=>()=>{var l;return((l=e(c))==null?void 0:l.value)==="Any"});Ne(()=>{var _;if(!((_=q)!=null&&_.TimelessJewels)||e(V)().length===0)return;if(u.has("jewel")&&!e(o)){const h=u.get("jewel");if(h){const P=e(V)().find(y=>y.value===parseInt(h));P&&d(o,P,!0)}}if(u.has("conqueror")&&!e(c)){const h=u.get("conqueror");h&&d(c,{value:h,label:h},!0)}if(u.has("seed")&&e(f)===0){const h=u.get("seed");if(h){const P=parseInt(h);isNaN(P)||d(f,P,!0)}}if(u.has("location")&&!e(p)){const h=u.get("location");if(h){const P=parseInt(h);isNaN(P)||d(p,P,!0)}}if(u.has("mode")&&!e(S)){const h=u.get("mode");h&&d(S,h,!0)}if(u.has("stat")&&Object.keys(e(v)).length===0){const h={};u.getAll("stat").forEach(P=>{const y=parseInt(P);isNaN(y)||(h[y]={weight:1,min:0,minStatTotal:0,id:y})}),d(v,h,!0)}const l=localStorage.getItem("groupResults");l!==null&&d(Y,l==="true")}),Ne(()=>{e(zt)()&&e(bt)().length>0?d(g,e(bt)()[0],!0):e(c)&&e(c).value!=="Any"&&d(g,e(c),!0)});let Ue=W(()=>()=>{var l,_;return!e(p)||!((_=(l=He)==null?void 0:l.nodes)!=null&&_[e(p)])?[]:Ns(He.nodes[e(p)]).filter(h=>!h.isJewelSocket&&!h.isMastery)}),ot=W(()=>()=>{var _,h,P;if(!e(f)||!e(o)||!e(g)||!((h=(_=q)==null?void 0:_.TimelessJewelConquerors)!=null&&h[e(o).value]))return[];const l=q.TimelessJewelConquerors[e(o).value];return!l||!Object.keys(l).includes(e(g).value)?[]:(P=q)!=null&&P.TreeToPassive?e(Ue)().filter(y=>y.skill!==void 0&&q.TreeToPassive[y.skill]).map(y=>{var O;return{node:y.skill,result:Ja.Calculate(((O=q.TreeToPassive[y.skill])==null?void 0:O.Index)||0,e(f),e(o).value,e(g).value)}}):[]}),Qe=W(()=>()=>{var l;return(l=q)!=null&&l.PossibleStats?JSON.parse(q.PossibleStats):{}}),Rr=W(()=>()=>!e(o)||!e(Qe)()[e(o).value]?[]:Object.keys(e(Qe)()[e(o).value])),Cr=W(()=>()=>e(Rr)().map(l=>{const _=parseInt(l);return{label:Tr(_),value:_}}).filter(l=>!(l.value in e(v))));Ne(()=>{localStorage.setItem("groupResults",e(Y)?"true":"false")});const Ce=()=>{var _;const l=new URL(window.location.origin+window.location.pathname);e(o)&&l.searchParams.append("jewel",e(o).value.toString()),(_=e(c))!=null&&_.value&&l.searchParams.append("conqueror",e(c).value),e(f)&&l.searchParams.append("seed",e(f).toString()),e(p)&&l.searchParams.append("location",e(p).toString()),e(S)&&l.searchParams.append("mode",e(S)),Object.keys(e(v)).forEach(h=>{l.searchParams.append("stat",h.toString())}),Ds(l.toString())},wt=l=>{d(S,l,!0),Ce()},Lt=l=>{if(l.isJewelSocket)d(p,l.skill,!0),Ce();else if(!l.isMastery&&l.skill!==void 0){const _=new Set(e(x));_.has(l.skill)?_.delete(l.skill):_.add(l.skill),d(x,_,!0)}},Dt=l=>{var h;const _={...e(v)};_[l.detail.value]={weight:1,min:0,minStatTotal:0,id:l.detail.value},d(v,_,!0),(h=e(ye))==null||h.handleClear(),Ce()},Wt=l=>{const _={...e(v)};delete _[l],d(v,_,!0),Ce()},mr=()=>{d(v,{},!0),Ce()},Mr=()=>{var _;if(!e(p)||!e(o)||!e(g)||(d(D,e(o).value,!0),d(z,e(zt)()?null:e(g).value,!0),d(M,!0),d(L,void 0),!((_=q)!=null&&_.TreeToPassive)))return;const l={jewel:e(o).value,conqueror:e(g).value,nodes:e(Ue)().filter(h=>h.skill!==void 0&&!e(x).has(h.skill)).map(h=>q.TreeToPassive[h.skill]).filter(h=>!!h).map(h=>h.Index),stats:Object.values(e(v)),minTotalWeight:e(T),minTotalStats:e(R)};zs.search(l,Ls(h=>d(ae,h,!0))).then(h=>{d(L,h,!0),d(M,!1),d(A,!0)})},Xe=(l,_)=>{d(f,l,!0),d(F,_,!0),Ce()},i={physical:"#c79d93",cast:"#b3f8fe",fire:"#ff9a77",cold:"#93d8ff",lightning:"#f8cb76",attack:"#da814d",life:"#c96e6e",chaos:"#d8a7d3",unique:"#af6025",critical:"#b2a7d6"},le=l=>(Object.keys(i).forEach(_=>{const h=i[_];l=l.replace(new RegExp(`(${_}(?:$|\\s))|((?:^|\\s)${_})`,"gi"),`<span style='color: ${h}; font-weight: bold'>$1$2</span>`)}),l),me=(l,_,h)=>{const P={};return l.forEach(y=>{var O;He.nodes[y.node].isKeystone||h!=="all"&&(h==="notables"&&!He.nodes[y.node].isNotable||h==="passives"&&He.nodes[y.node].isNotable)||((O=y.result.AlternatePassiveSkill)!=null&&O.StatsKeys&&y.result.AlternatePassiveSkill.StatsKeys.forEach(H=>{P[H]=[...P[H]||[],y.node]}),y.result.AlternatePassiveAdditionInformations&&y.result.AlternatePassiveAdditionInformations.forEach(H=>{var te;(te=H.AlternatePassiveAddition)!=null&&te.StatsKeys&&H.AlternatePassiveAddition.StatsKeys.forEach(xe=>{P[xe]=[...P[xe]||[],y.node]})}))}),Object.keys(P).map(y=>{const O=Tr(parseInt(y));return{stat:_?le(O):O,rawStat:O,id:y,passives:P[parseInt(y)]}})},se=(l,_)=>{if(!e(o))return l;switch(_){case"alphabet":return l.sort((y,O)=>y.rawStat.replace(/[#+%]/gi,"").trim().toLowerCase().localeCompare(O.rawStat.replace(/[#+%]/gi,"").trim().toLowerCase()));case"count":return l.sort((y,O)=>O.passives.length-y.passives.length);case"rarity":const h=e(o);return h?l.sort((y,O)=>{var H,te;return(((H=e(Qe)()[h.value])==null?void 0:H[y.id])||0)-(((te=e(Qe)()[h.value])==null?void 0:te[O.id])||0)}):l;case"value":const P=e(o);return P?l.sort((y,O)=>{var xe,he;const H=nr[y.id]||0,te=nr[O.id]||0;return H!=te?te-H:(((xe=e(Qe)()[P.value])==null?void 0:xe[y.id])||0)-(((he=e(Qe)()[P.value])==null?void 0:he[O.id])||0)}):l}return l},de=[{label:"Count",value:"count"},{label:"Alphabetical",value:"alphabet"},{label:"Rarity",value:"rarity"},{label:"Value",value:"value"}];let U=N(void 0),ee=N(!0),ne=N(!0);Ne(()=>{const l=localStorage.getItem("sortOrder")||"count";d(U,de.find(P=>P.value===l),!0);const _=localStorage.getItem("colored");d(ee,_===null?!0:_==="true",!0);const h=localStorage.getItem("split");d(ne,h===null?!0:h==="true",!0)}),Ne(()=>{e(U)&&localStorage.setItem("sortOrder",e(U).value)}),Ne(()=>{localStorage.setItem("colored",e(ee)?"true":"false")}),Ne(()=>{localStorage.setItem("split",e(ne)?"true":"false")});const Ze=l=>{var H,te,xe;if(l.type!=="paste")return;const h=(((H=l.clipboardData)==null?void 0:H.getData("text"))||"").split(`
`);if(h.length<14)return;const P=e(V)().find(he=>he.label===h[2]);if(!P)return;let y,O;if((xe=(te=q)==null?void 0:te.TimelessJewelConquerors)!=null&&xe[P.value]){for(let he=10;he<h.length;he++)if(O=Object.keys(q.TimelessJewelConquerors[P.value]||{}).find(Ae=>h[he].indexOf(Ae)>=0),O){const Ae=/(\d+)/.exec(h[he]);if(!Ae||Ae.length===0)continue;y=parseInt(Ae[1]);break}!O||!y||(d(A,!1),d(S,"seed"),d(f,y,!0),d(o,P,!0),d(g,{label:O,value:O},!0),d(c,{label:O,value:O},!0),Ce())}};let Q=N(!1),I=N(!1),j=W(()=>()=>!e(L)||!e(D)||!e(z)?[]:qs(e(D),e(z),e(L).raw));Ne(()=>{e(j)().length===1&&d(I,!1)}),It("paste",lr,Ze);const X=W(()=>{var l;return((l=e(o))==null?void 0:l.value)??0}),B=W(()=>{var l;return((l=e(g))==null?void 0:l.value)??""}),Be=W(()=>!e(p)),Me=W(()=>Array.from(e(x)));bn(a,{clickNode:Lt,get circledNode(){return e(p)},get selectedJewel(){return e(X)},get selectedConqueror(){return e(B)},get highlighted(){return e(F)},get seed(){return e(f)},get highlightJewels(){return e(Be)},get disabled(){return e(Me)},children:(l,_)=>{var h=Ei(),P=ge(h);{var y=H=>{var te=ki(),xe=w(te),he=w(xe),Ae=w(he),ra=w(Ae);ra.__click=[Yn,Q];var aa=k(ra,2),Ka=w(aa);{var Ua=oe=>{var Se=Hn();E(oe,Se)},Xa=oe=>{var Se=Kn();E(oe,Se)};Z(Ka,oe=>{e(A)?oe(Ua):oe(Xa,!1)})}m(aa),m(Ae);var Ba=k(Ae,2);{var Ga=oe=>{var Se=Gn(),$e=w(Se);{var Ft=ke=>{var dt=Xn(),yt=ge(dt);const jr=W(()=>e(j)());jn(yt,{get queries(){return e(jr)},get showTradeLinks(){return e(I)},set showTradeLinks(Kt){d(I,Kt,!0)}});var Ht=k(yt,2);let pr;Ht.__click=[Un,Y],$(Kt=>{pr=qe(Ht,1,"p-1 px-3 bg-blue-500/40 rounded disabled:bg-blue-900/40 mr-2",null,pr,Kt),Ht.disabled=!e(L)},[()=>({grouped:e(Y)})]),E(ke,dt)};Z($e,ke=>{e(A)&&ke(Ft)})}var ct=k($e,2);ct.__click=[Bn,A];var Yt=w(ct,!0);m(ct),m(Se),$(()=>Re(Yt,e(A)?"Config":"Results")),E(oe,Se)};Z(Ba,oe=>{e(L)&&oe(Ga)})}m(he);var sa=k(he,2);{var Va=oe=>{var Se=xi(),$e=ge(Se);const Ft=W(()=>e(V)());wr($e,{get items(){return e(Ft)},get value(){return e(o)},set value(ke){d(o,ke,!0)},$$events:{change:mr}});var ct=k($e,2);{var Yt=ke=>{var dt=yi(),yt=ge(dt),jr=k(w(yt),2);const Ht=W(()=>e(gr)());wr(jr,{get items(){return e(Ht)},get value(){return e(c)},set value(Ut){d(c,Ut,!0)},$$events:{change:Ce}}),m(yt);var pr=k(yt,2);{var Kt=Ut=>{var Xt=wi(),xt=ge(Xt),Jr=w(xt);let na;Jr.__click=[Vn,wt];var ia=k(Jr,2);let la;ia.__click=[Qn,wt],m(xt);var oa=k(xt,2);{var $a=Oe=>{var et=vi(),Bt=ge(et),Le=k(w(Bt),2);Pt(Le);var _r=k(Le,2);{var Gt=pe=>{var fe=Zn(),re=w(fe);m(fe),$(()=>Re(re,`Seed must be between ${q.TimelessJewelSeedRanges[e(o).value].Min??""}
                      and ${q.TimelessJewelSeedRanges[e(o).value].Max??""}`)),E(pe,fe)};Z(_r,pe=>{var fe,re;(re=(fe=q)==null?void 0:fe.TimelessJewelSeedRanges)!=null&&re[e(o).value]&&(e(f)<q.TimelessJewelSeedRanges[e(o).value].Min||e(f)>q.TimelessJewelSeedRanges[e(o).value].Max)&&pe(Gt)})}m(Bt);var qr=k(Bt,2);{var Nr=pe=>{var fe=fi(),re=ge(fe),Ge=w(re),tt=k(w(Ge),2);wr(tt,{get items(){return de},get value(){return e(U)},set value(_e){d(U,_e,!0)}}),m(Ge);var De=k(Ge,2),St=w(De);let Vt;St.__click=[$n,ee],m(De);var Qt=k(De,2),Zt=w(Qt);let $t;Zt.__click=[ei,ne],m(Qt),m(re);var er=k(re,2);{var tr=_e=>{var Te=si();let We;Ke(Te,21,()=>{var be;return se(me(e(ot)(),e(ee),"all"),((be=e(U))==null?void 0:be.value)??"count")},pt,(be,je)=>{var rt=ai(),ue=w(rt);ue.__click=[ti,Xe,f,je],ue.__keydown=[ri,Xe,f,je];var J=w(ue);let K;var ce=w(J);m(J);var ie=k(J,2),Pe=w(ie);Yr(Pe,()=>e(je).stat),m(ie),m(ue),m(rt),$(at=>{K=qe(J,1,"font-bold",null,K,at),Re(ce,`(${e(je).passives.length??""})`)},[()=>({"text-white":(nr[e(je).id]||0)<3})]),E(be,rt)}),m(Te),$(be=>We=qe(Te,1,"mt-4 overflow-auto",null,We,be),[()=>({rainbow:e(ee)})]),E(_e,Te)},rr=_e=>{var Te=di(),We=k(w(Te),2);let be;Ke(We,21,()=>{var ue;return se(me(e(ot)(),e(ee),"notables"),((ue=e(U))==null?void 0:ue.value)??"count")},pt,(ue,J)=>{var K=li(),ce=w(K);ce.__click=[ni,Xe,f,J],ce.__keydown=[ii,Xe,f,J];var ie=w(ce);let Pe;var at=w(ie);m(ie);var ft=k(ie,2),kt=w(ft);Yr(kt,()=>e(J).stat),m(ft),m(ce),m(K),$(vt=>{Pe=qe(ie,1,"font-bold",null,Pe,vt),Re(at,`(${e(J).passives.length??""})`)},[()=>({"text-white":(nr[e(J).id]||0)<3})]),E(ue,K)}),m(We);var je=k(We,4);let rt;Ke(je,21,()=>{var ue;return se(me(e(ot)(),e(ee),"passives"),((ue=e(U))==null?void 0:ue.value)??"count")},pt,(ue,J)=>{var K=ci(),ce=w(K);ce.__click=[oi,Xe,f,J],ce.__keydown=[ui,Xe,f,J];var ie=w(ce);let Pe;var at=w(ie);m(ie);var ft=k(ie,2),kt=w(ft);Yr(kt,()=>e(J).stat),m(ft),m(ce),m(K),$(vt=>{Pe=qe(ie,1,"font-bold",null,Pe,vt),Re(at,`(${e(J).passives.length??""})`)},[()=>({"text-white":(nr[e(J).id]||0)<3})]),E(ue,K)}),m(je),m(Te),$((ue,J)=>{be=qe(We,1,"mt-1",null,be,ue),rt=qe(je,1,"mt-1",null,rt,J)},[()=>({rainbow:e(ee)}),()=>({rainbow:e(ee)})]),E(_e,Te)};Z(er,_e=>{e(ne)?_e(rr,!1):_e(tr)})}$((_e,Te)=>{Vt=qe(St,1,"bg-neutral-500 opacity-20 p-2 px-4 rounded",null,Vt,_e),$t=qe(Zt,1,"bg-neutral-500 opacity-20 p-2 px-4 rounded",null,$t,Te)},[()=>({selected:e(ee)}),()=>({selected:e(ne)})]),E(pe,fe)};Z(qr,pe=>{var fe,re;(re=(fe=q)==null?void 0:fe.TimelessJewelSeedRanges)!=null&&re[e(o).value]&&e(f)>=q.TimelessJewelSeedRanges[e(o).value].Min&&e(f)<=q.TimelessJewelSeedRanges[e(o).value].Max&&pe(Nr)})}$(()=>{var pe,fe,re,Ge,tt,De;Br(Le,"min",(re=(fe=(pe=q)==null?void 0:pe.TimelessJewelSeedRanges)==null?void 0:fe[e(o).value])==null?void 0:re.Min),Br(Le,"max",(De=(tt=(Ge=q)==null?void 0:Ge.TimelessJewelSeedRanges)==null?void 0:tt[e(o).value])==null?void 0:De.Max)}),It("blur",Le,Ce),Et(Le,()=>e(f),pe=>d(f,pe)),E(Oe,et)},es=(Oe,et)=>{{var Bt=Le=>{var _r=_i(),Gt=ge(_r),qr=k(w(Gt),2);const Nr=W(()=>e(Cr)());Gr(wr(qr,{get items(){return e(Nr)},$$events:{change:Dt}}),re=>d(ye,re,!0),()=>e(ye)),m(Gt);var pe=k(Gt,2);{var fe=re=>{var Ge=pi(),tt=ge(Ge);Ke(tt,21,()=>Object.keys(e(v)),pt,(J,K)=>{var ce=gi(),ie=w(ce),Pe=w(ie);Pe.__click=[hi,Wt,v,K];var at=k(Pe,2),ft=w(at,!0);m(at),m(ie);var kt=k(ie,2),vt=w(kt),ua=k(w(vt),2);Pt(ua),m(vt);var zr=k(vt,2),ca=k(w(zr),2);Pt(ca),m(zr);var da=k(zr,2),fa=k(w(da),2);Pt(fa),m(da),m(kt),m(ce),$(ht=>Re(ft,ht),[()=>Tr(e(v)[parseInt(e(K))].id)]),Et(ua,()=>e(v)[parseInt(e(K))].min,ht=>e(v)[parseInt(e(K))].min=ht),Et(ca,()=>e(v)[parseInt(e(K))].weight,ht=>e(v)[parseInt(e(K))].weight=ht),Et(fa,()=>e(v)[parseInt(e(K))].minStatTotal,ht=>e(v)[parseInt(e(K))].minStatTotal=ht),E(J,ce)}),m(tt);var De=k(tt,2),St=w(De),Vt=k(w(St),2);Pt(Vt),m(St);var Qt=k(St,2),Zt=k(w(Qt),2);Pt(Zt),m(Qt),m(De);var $t=k(De,2),er=w($t),tr=w(er);tr.__click=[Ln,x];var rr=k(tr,2);rr.__click=[Dn,x,Ue];var _e=k(rr,2);_e.__click=[Wn,x,Ue];var Te=k(_e,2);Te.__click=[Fn,Ue,x],m(er);var We=k(er,2),be=w(We);be.__click=[mi,Mr];var je=w(be);{var rt=J=>{var K=ir();$(()=>{var ce,ie,Pe;return Re(K,`${e(ae)??""} / ${((Pe=(ie=(ce=q)==null?void 0:ce.TimelessJewelSeedRanges)==null?void 0:ie[e(o).value])==null?void 0:Pe.Max)??""}`)}),E(J,K)},ue=J=>{var K=ir("Search");E(J,K)};Z(je,J=>{e(M)?J(rt):J(ue,!1)})}m(be),m(We),m($t),$(J=>{tr.disabled=e(M)||e(x).size==0,rr.disabled=e(M)||e(x).size==0,_e.disabled=e(M)||e(x).size==0,Te.disabled=J,be.disabled=e(M)},[()=>e(M)||e(x).size>=e(Ue)().length]),Et(Vt,()=>e(T),J=>d(T,J)),Et(Zt,()=>e(R),J=>d(R,J)),E(re,Ge)};Z(pe,re=>{Object.keys(e(v)).length>0&&re(fe)})}E(Le,_r)};Z(Oe,Le=>{e(S)==="stats"&&Le(Bt)},et)}};Z(oa,Oe=>{e(S)==="seed"?Oe($a):Oe(es,!1)})}var ts=k(oa,2);{var rs=Oe=>{var et=bi();E(Oe,et)};Z(ts,Oe=>{e(p)||Oe(rs)})}$((Oe,et)=>{na=qe(Jr,1,"selection-button",null,na,Oe),la=qe(ia,1,"selection-button",null,la,et)},[()=>({selected:e(S)==="seed"}),()=>({selected:e(S)==="stats"})]),E(Ut,Xt)};Z(pr,Ut=>{var Xt,xt;e(g)&&((xt=(Xt=q)==null?void 0:Xt.TimelessJewelConquerors)!=null&&xt[e(o).value])&&Object.keys(q.TimelessJewelConquerors[e(o).value]||{}).includes(e(g).value)&&Ut(Kt)})}E(ke,dt)};Z(ct,ke=>{e(o)&&ke(Yt)})}E(oe,Se)};Z(sa,oe=>{e(A)||oe(Va)})}var Qa=k(sa,2);{var Za=oe=>{var Se=Si(),$e=ge(Se);{var Ft=ke=>{const dt=W(()=>e(j)());zn(ke,{get queries(){return e(dt)}})};Z($e,ke=>{e(I)&&ke(Ft)})}var ct=k($e,2);const Yt=W(()=>e(z)||"");Rn(ct,{get searchResults(){return e(L)},get groupResults(){return e(Y)},highlight:Xe,get jewel(){return e(D)},get conqueror(){return e(Yt)}}),E(oe,Se)};Z(Qa,oe=>{e(L)&&e(A)&&oe(Za)})}m(xe),m(te),E(H,te)},O=H=>{var te=Pi();te.__click=[Ti,Q],E(H,te)};Z(P,H=>{e(Q)?H(O,!1):H(y)})}ks(2),E(l,h)},$$slots:{default:!0}});var ut=lt({colorKeys:i});return s(),ut}hr(["click","keydown"]);export{Di as component};
