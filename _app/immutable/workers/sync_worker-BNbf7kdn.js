(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const I=Symbol("Comlink.proxy"),B=Symbol("Comlink.endpoint"),L=Symbol("Comlink.releaseProxy"),_=Symbol("Comlink.finalizer"),S=Symbol("Comlink.thrown"),A=t=>typeof t=="object"&&t!==null||typeof t=="function",W={canHandle:t=>A(t)&&t[I],serialize(t){const{port1:i,port2:o}=new MessageChannel;return j(t,i),[o,[o]]},deserialize(t){return t.start(),q(t)}},z={canHandle:t=>A(t)&&S in t,serialize({value:t}){let i;return t instanceof Error?i={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:i={isError:!1,value:t},[i,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},R=new Map([["proxy",W],["throw",z]]);function F(t,i){for(const o of t)if(i===o||o==="*"||o instanceof RegExp&&o.test(i))return!0;return!1}function j(t,i=globalThis,o=["*"]){i.addEventListener("message",function c(n){if(!n||!n.data)return;if(!F(o,n.origin)){console.warn(`Invalid origin '${n.origin}' for comlink proxy`);return}const{id:r,type:a,path:l}=Object.assign({path:[]},n.data),m=(n.data.argumentList||[]).map(b);let h;try{const g=l.slice(0,-1).reduce((s,u)=>s[u],t),e=l.reduce((s,u)=>s[u],t);switch(a){case"GET":h=e;break;case"SET":g[l.slice(-1)[0]]=b(n.data.value),h=!0;break;case"APPLY":h=e.apply(g,m);break;case"CONSTRUCT":{const s=new e(...m);h=Q(s)}break;case"ENDPOINT":{const{port1:s,port2:u}=new MessageChannel;j(t,u),h=K(s,[s])}break;case"RELEASE":h=void 0;break;default:return}}catch(g){h={value:g,[S]:0}}Promise.resolve(h).catch(g=>({value:g,[S]:0})).then(g=>{const[e,s]=x(g);i.postMessage(Object.assign(Object.assign({},e),{id:r}),s),a==="RELEASE"&&(i.removeEventListener("message",c),C(i),_ in t&&typeof t[_]=="function"&&t[_]())}).catch(g=>{const[e,s]=x({value:new TypeError("Unserializable return value"),[S]:0});i.postMessage(Object.assign(Object.assign({},e),{id:r}),s)})}),i.start&&i.start()}function H(t){return t.constructor.name==="MessagePort"}function C(t){H(t)&&t.close()}function q(t,i){const o=new Map;return t.addEventListener("message",function(n){const{data:r}=n;if(!r||!r.id)return;const a=o.get(r.id);if(a)try{a(r)}finally{o.delete(r.id)}}),O(t,o,[],i)}function v(t){if(t)throw new Error("Proxy has been released and is not useable")}function U(t){return T(t,new Map,{type:"RELEASE"}).then(()=>{C(t)})}const k=new WeakMap,E="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const i=(k.get(t)||0)-1;k.set(t,i),i===0&&U(t)});function Y(t,i){const o=(k.get(i)||0)+1;k.set(i,o),E&&E.register(t,i,t)}function $(t){E&&E.unregister(t)}function O(t,i,o=[],c=function(){}){let n=!1;const r=new Proxy(c,{get(a,l){if(v(n),l===L)return()=>{$(r),U(t),i.clear(),n=!0};if(l==="then"){if(o.length===0)return{then:()=>r};const m=T(t,i,{type:"GET",path:o.map(h=>h.toString())}).then(b);return m.then.bind(m)}return O(t,i,[...o,l])},set(a,l,m){v(n);const[h,g]=x(m);return T(t,i,{type:"SET",path:[...o,l].map(e=>e.toString()),value:h},g).then(b)},apply(a,l,m){v(n);const h=o[o.length-1];if(h===B)return T(t,i,{type:"ENDPOINT"}).then(b);if(h==="bind")return O(t,i,o.slice(0,-1));const[g,e]=N(m);return T(t,i,{type:"APPLY",path:o.map(s=>s.toString()),argumentList:g},e).then(b)},construct(a,l){v(n);const[m,h]=N(l);return T(t,i,{type:"CONSTRUCT",path:o.map(g=>g.toString()),argumentList:m},h).then(b)}});return Y(r,t),r}function X(t){return Array.prototype.concat.apply([],t)}function N(t){const i=t.map(x);return[i.map(o=>o[0]),X(i.map(o=>o[1]))]}const D=new WeakMap;function K(t,i){return D.set(t,i),t}function Q(t){return Object.assign(t,{[I]:!0})}function x(t){for(const[i,o]of R)if(o.canHandle(t)){const[c,n]=o.serialize(t);return[{type:"HANDLER",name:i,value:c},n]}return[{type:"RAW",value:t},D.get(t)||[]]}function b(t){switch(t.type){case"HANDLER":return R.get(t.name).deserialize(t.value);case"RAW":return t.value}}function T(t,i,o,c){return new Promise(n=>{const r=Z();i.set(r,n),t.start&&t.start(),t.postMessage(Object.assign({id:r},o),c)})}function Z(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}(()=>{const t=()=>{const c=new Error("not implemented");return c.code="ENOSYS",c};if(!globalThis.fs){let c="";globalThis.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(n,r){c+=o.decode(r);const a=c.lastIndexOf(`
`);return a!=-1&&(console.log(c.substring(0,a)),c=c.substring(a+1)),r.length},write(n,r,a,l,m,h){if(a!==0||l!==r.length||m!==null){h(t());return}const g=this.writeSync(n,r);h(null,g)},chmod(n,r,a){a(t())},chown(n,r,a,l){l(t())},close(n,r){r(t())},fchmod(n,r,a){a(t())},fchown(n,r,a,l){l(t())},fstat(n,r){r(t())},fsync(n,r){r(null)},ftruncate(n,r,a){a(t())},lchown(n,r,a,l){l(t())},link(n,r,a){a(t())},lstat(n,r){r(t())},mkdir(n,r,a){a(t())},open(n,r,a,l){l(t())},read(n,r,a,l,m,h){h(t())},readdir(n,r){r(t())},readlink(n,r){r(t())},rename(n,r,a){a(t())},rmdir(n,r){r(t())},stat(n,r){r(t())},symlink(n,r,a){a(t())},truncate(n,r,a){a(t())},unlink(n,r){r(t())},utimes(n,r,a,l){l(t())}}}if(globalThis.process||(globalThis.process={getuid(){return-1},getgid(){return-1},geteuid(){return-1},getegid(){return-1},getgroups(){throw t()},pid:-1,ppid:-1,umask(){throw t()},cwd(){throw t()},chdir(){throw t()}}),!globalThis.crypto)throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");if(!globalThis.performance)throw new Error("globalThis.performance is not available, polyfill required (performance.now only)");if(!globalThis.TextEncoder)throw new Error("globalThis.TextEncoder is not available, polyfill required");if(!globalThis.TextDecoder)throw new Error("globalThis.TextDecoder is not available, polyfill required");const i=new TextEncoder("utf-8"),o=new TextDecoder("utf-8");globalThis.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=e=>{e!==0&&console.warn("exit code:",e)},this._exitPromise=new Promise(e=>{this._resolveExitPromise=e}),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;const c=(e,s)=>{this.mem.setUint32(e+0,s,!0),this.mem.setUint32(e+4,Math.floor(s/4294967296),!0)},n=e=>{const s=this.mem.getUint32(e+0,!0),u=this.mem.getInt32(e+4,!0);return s+u*4294967296},r=e=>{const s=this.mem.getFloat64(e,!0);if(s===0)return;if(!isNaN(s))return s;const u=this.mem.getUint32(e,!0);return this._values[u]},a=(e,s)=>{if(typeof s=="number"&&s!==0){if(isNaN(s)){this.mem.setUint32(e+4,2146959360,!0),this.mem.setUint32(e,0,!0);return}this.mem.setFloat64(e,s,!0);return}if(s===void 0){this.mem.setFloat64(e,0,!0);return}let f=this._ids.get(s);f===void 0&&(f=this._idPool.pop(),f===void 0&&(f=this._values.length),this._values[f]=s,this._goRefCounts[f]=0,this._ids.set(s,f)),this._goRefCounts[f]++;let y=0;switch(typeof s){case"object":s!==null&&(y=1);break;case"string":y=2;break;case"symbol":y=3;break;case"function":y=4;break}this.mem.setUint32(e+4,2146959360|y,!0),this.mem.setUint32(e,f,!0)},l=e=>{const s=n(e+0),u=n(e+8);return new Uint8Array(this._inst.exports.mem.buffer,s,u)},m=e=>{const s=n(e+0),u=n(e+8),f=new Array(u);for(let y=0;y<u;y++)f[y]=r(s+y*8);return f},h=e=>{const s=n(e+0),u=n(e+8);return o.decode(new DataView(this._inst.exports.mem.buffer,s,u))},g=Date.now()-performance.now();this.importObject={_gotest:{add:(e,s)=>e+s},gojs:{"runtime.wasmExit":e=>{e>>>=0;const s=this.mem.getInt32(e+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(s)},"runtime.wasmWrite":e=>{e>>>=0;const s=n(e+8),u=n(e+16),f=this.mem.getInt32(e+24,!0);fs.writeSync(s,new Uint8Array(this._inst.exports.mem.buffer,u,f))},"runtime.resetMemoryDataView":e=>{this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":e=>{e>>>=0,c(e+8,(g+performance.now())*1e6)},"runtime.walltime":e=>{e>>>=0;const s=new Date().getTime();c(e+8,s/1e3),this.mem.setInt32(e+16,s%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":e=>{e>>>=0;const s=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(s,setTimeout(()=>{for(this._resume();this._scheduledTimeouts.has(s);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()},n(e+8))),this.mem.setInt32(e+16,s,!0)},"runtime.clearTimeoutEvent":e=>{e>>>=0;const s=this.mem.getInt32(e+8,!0);clearTimeout(this._scheduledTimeouts.get(s)),this._scheduledTimeouts.delete(s)},"runtime.getRandomData":e=>{e>>>=0,crypto.getRandomValues(l(e+8))},"syscall/js.finalizeRef":e=>{e>>>=0;const s=this.mem.getUint32(e+8,!0);if(this._goRefCounts[s]--,this._goRefCounts[s]===0){const u=this._values[s];this._values[s]=null,this._ids.delete(u),this._idPool.push(s)}},"syscall/js.stringVal":e=>{e>>>=0,a(e+24,h(e+8))},"syscall/js.valueGet":e=>{e>>>=0;const s=Reflect.get(r(e+8),h(e+16));e=this._inst.exports.getsp()>>>0,a(e+32,s)},"syscall/js.valueSet":e=>{e>>>=0,Reflect.set(r(e+8),h(e+16),r(e+32))},"syscall/js.valueDelete":e=>{e>>>=0,Reflect.deleteProperty(r(e+8),h(e+16))},"syscall/js.valueIndex":e=>{e>>>=0,a(e+24,Reflect.get(r(e+8),n(e+16)))},"syscall/js.valueSetIndex":e=>{e>>>=0,Reflect.set(r(e+8),n(e+16),r(e+24))},"syscall/js.valueCall":e=>{e>>>=0;try{const s=r(e+8),u=Reflect.get(s,h(e+16)),f=m(e+32),y=Reflect.apply(u,s,f);e=this._inst.exports.getsp()>>>0,a(e+56,y),this.mem.setUint8(e+64,1)}catch(s){e=this._inst.exports.getsp()>>>0,a(e+56,s),this.mem.setUint8(e+64,0)}},"syscall/js.valueInvoke":e=>{e>>>=0;try{const s=r(e+8),u=m(e+16),f=Reflect.apply(s,void 0,u);e=this._inst.exports.getsp()>>>0,a(e+40,f),this.mem.setUint8(e+48,1)}catch(s){e=this._inst.exports.getsp()>>>0,a(e+40,s),this.mem.setUint8(e+48,0)}},"syscall/js.valueNew":e=>{e>>>=0;try{const s=r(e+8),u=m(e+16),f=Reflect.construct(s,u);e=this._inst.exports.getsp()>>>0,a(e+40,f),this.mem.setUint8(e+48,1)}catch(s){e=this._inst.exports.getsp()>>>0,a(e+40,s),this.mem.setUint8(e+48,0)}},"syscall/js.valueLength":e=>{e>>>=0,c(e+16,parseInt(r(e+8).length))},"syscall/js.valuePrepareString":e=>{e>>>=0;const s=i.encode(String(r(e+8)));a(e+16,s),c(e+24,s.length)},"syscall/js.valueLoadString":e=>{e>>>=0;const s=r(e+8);l(e+16).set(s)},"syscall/js.valueInstanceOf":e=>{e>>>=0,this.mem.setUint8(e+24,r(e+8)instanceof r(e+16)?1:0)},"syscall/js.copyBytesToGo":e=>{e>>>=0;const s=l(e+8),u=r(e+32);if(!(u instanceof Uint8Array||u instanceof Uint8ClampedArray)){this.mem.setUint8(e+48,0);return}const f=u.subarray(0,s.length);s.set(f),c(e+40,f.length),this.mem.setUint8(e+48,1)},"syscall/js.copyBytesToJS":e=>{e>>>=0;const s=r(e+8),u=l(e+16);if(!(s instanceof Uint8Array||s instanceof Uint8ClampedArray)){this.mem.setUint8(e+48,0);return}const f=u.subarray(0,s.length);s.set(f),c(e+40,f.length),this.mem.setUint8(e+48,1)},debug:e=>{console.log(e)}}}}async run(c){if(!(c instanceof WebAssembly.Instance))throw new Error("Go.run: WebAssembly.Instance expected");this._inst=c,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,globalThis,this],this._goRefCounts=new Array(this._values.length).fill(1/0),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[globalThis,5],[this,6]]),this._idPool=[],this.exited=!1;let n=4096;const r=e=>{const s=n,u=i.encode(e+"\0");return new Uint8Array(this.mem.buffer,n,u.length).set(u),n+=u.length,n%8!==0&&(n+=8-n%8),s},a=this.argv.length,l=[];this.argv.forEach(e=>{l.push(r(e))}),l.push(0),Object.keys(this.env).sort().forEach(e=>{l.push(r(`${e}=${this.env[e]}`))}),l.push(0);const h=n;if(l.forEach(e=>{this.mem.setUint32(n,e,!0),this.mem.setUint32(n+4,0,!0),n+=8}),n>=12288)throw new Error("total length of command line and environment variables exceeds limit");this._inst.exports.run(a,h),this.exited&&this._resolveExitPromise(),await this._exitPromise}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(c){const n=this;return function(){const r={id:c,this:this,args:arguments};return n._pendingEvent=r,n._resume(),r.result}}}})();let M,w;const ee=()=>{M={Calculate:globalThis.go["timeless-jewels"].calculator.Calculate,ReverseSearch:globalThis.go["timeless-jewels"].calculator.ReverseSearch},w={GetAlternatePassiveAdditionByIndex:globalThis.go["timeless-jewels"].data.GetAlternatePassiveAdditionByIndex,GetAlternatePassiveSkillByIndex:globalThis.go["timeless-jewels"].data.GetAlternatePassiveSkillByIndex,GetPassiveSkillByIndex:globalThis.go["timeless-jewels"].data.GetPassiveSkillByIndex,GetStatByIndex:globalThis.go["timeless-jewels"].data.GetStatByIndex,PassiveSkillAuraStatTranslationsJSON:globalThis.go["timeless-jewels"].data.PassiveSkillAuraStatTranslationsJSON,PassiveSkillStatTranslationsJSON:globalThis.go["timeless-jewels"].data.PassiveSkillStatTranslationsJSON,PassiveSkills:globalThis.go["timeless-jewels"].data.PassiveSkills,PossibleStats:globalThis.go["timeless-jewels"].data.PossibleStats,SkillTree:globalThis.go["timeless-jewels"].data.SkillTree,StatTranslationsJSON:globalThis.go["timeless-jewels"].data.StatTranslationsJSON,TimelessJewelConquerors:globalThis.go["timeless-jewels"].data.TimelessJewelConquerors,TimelessJewelSeedRanges:globalThis.go["timeless-jewels"].data.TimelessJewelSeedRanges,TimelessJewels:globalThis.go["timeless-jewels"].data.TimelessJewels,TreeToPassive:globalThis.go["timeless-jewels"].data.TreeToPassive}};let d;const P={},te=()=>{d=JSON.parse(w.SkillTree),console.log("Loaded skill tree",d),Object.keys(d.groups).forEach(i=>{d.groups[i].nodes.forEach(c=>{const n=d.nodes[c];n.isProxy||"classStartIndex"in n||n.expansionJewel&&n.expansionJewel.parent||n.isBlighted||n.ascendancyName})}),Object.keys(d.sprites.keystoneInactive["0.3835"].coords).forEach(i=>d.sprites.keystoneInactive["0.3835"]),Object.keys(d.sprites.notableInactive["0.3835"].coords).forEach(i=>d.sprites.notableInactive["0.3835"]),Object.keys(d.sprites.normalInactive["0.3835"].coords).forEach(i=>d.sprites.normalInactive["0.3835"]),Object.keys(d.sprites.masteryInactive["0.3835"].coords).forEach(i=>d.sprites.masteryInactive["0.3835"]),Object.keys(d.sprites.keystoneActive["0.3835"].coords).forEach(i=>d.sprites.keystoneActive["0.3835"]),Object.keys(d.sprites.notableActive["0.3835"].coords).forEach(i=>d.sprites.notableActive["0.3835"]),Object.keys(d.sprites.normalActive["0.3835"].coords).forEach(i=>d.sprites.normalActive["0.3835"]),Object.keys(d.sprites.masteryInactive["0.3835"].coords).forEach(i=>d.sprites.masteryInactive["0.3835"]),Object.keys(d.sprites.groupBackground["0.3835"].coords).forEach(i=>d.sprites.groupBackground["0.3835"]),Object.keys(d.sprites.frame["0.3835"].coords).forEach(i=>d.sprites.frame["0.3835"]),[w.StatTranslationsJSON,w.PassiveSkillStatTranslationsJSON,w.PassiveSkillAuraStatTranslationsJSON].forEach(i=>{JSON.parse(i).descriptors.forEach(c=>{c.ids.forEach(n=>{})})}),w.TreeToPassive&&Object.keys(w.TreeToPassive).forEach(i=>{var c;const o=(c=w.TreeToPassive)==null?void 0:c[parseInt(i)];o&&(P[o.Index]=parseInt(i))})};j({boot(t){const i=new Go;WebAssembly.instantiate(t,i.importObject).then(o=>{i.run(o.instance),ee(),te()})},async search(t,i){const o=await M.ReverseSearch(t.nodes,t.stats.map(n=>n.id),t.jewel,t.conqueror,i),c={};return o?(Object.keys(o).forEach(n=>{const r=parseInt(n),a=o[r];if(!a)return;let l=0,m=0;const h={},g={},e=Object.keys(a).map(u=>{const f=parseInt(u),y=a[f];return y?(Object.keys(y).forEach(J=>{var V;const p=parseInt(J);h[p]=(h[p]||0)+1,l+=((V=t.stats.find(se=>se.id==p))==null?void 0:V.weight)||0;const G=y[parseInt(J)];g[p]=(g[p]??0)+G,m+=G}),{passive:P[f]||f,stats:y}):{passive:P[f]||f,stats:{}}}),s=Object.keys(a).length;c[s]=[...c[s]||[],{skills:e,seed:r,weight:l,statCounts:h,statTotal:g,totalStats:m}]}),Object.keys(c).forEach(n=>{const r=parseInt(n),a=c[r].filter(l=>{if(l.weight<t.minTotalWeight)return!1;for(const m of t.stats)if(l.statCounts[m.id]===void 0&&m.min>0||l.statCounts[m.id]<m.min||l.statTotal[m.id]<m.minStatTotal)return!1;return!(l.totalStats<t.minTotalStats)});a.length===0?delete c[r]:c[r]=a.sort((l,m)=>m.weight-l.weight)}),{grouped:c,raw:Object.keys(c).map(n=>c[parseInt(n)]).flat().sort((n,r)=>r.weight-n.weight)}):{grouped:{},raw:[]}}})})();
